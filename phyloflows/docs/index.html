<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimating transmission flows within and between population groups from deep sequence data • phyloflows</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimating transmission flows within and between population groups from deep sequence data">
<meta property="og:description" content="This package provides an MCMC algorithm to infer transmission flows within and between population groups from observed flow counts. 
    The software was primarily written to estimate transmission flows from counts of phylogenetically reconstructed source-recipient pairs. 
    These input data can be obtained with phyloscannerR in the parent repository, though different types of input data can also be used, so long as they represent observed counts of flow events between two discrete groups. 
    The primary feature of the software is that the underlying statistical model allows adjusting for sampling heterogeneity across population groups, a common problem in molecular epidemiologic analyses.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">phyloflows</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/01_simulating_data.html">01 - Simulating data</a>
    </li>
    <li>
      <a href="articles/02_basic_example.html">02 - Very first example</a>
    </li>
    <li>
      <a href="articles/03_diagnostics.html">03 - Performing MCMC diagnostic checks</a>
    </li>
    <li>
      <a href="articles/04_aggregating.html">04 - Aggregating MCMC output to a new set of variables</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/BDI-pathogens/phyloscanner">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<div id="phyloflows" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#phyloflows" class="anchor"></a><strong>phyloflows</strong>
</h1></div>
<p><strong>phyloflows</strong> provides tools to infer transmission flows within and between population groups from phylogenetically observed flow counts.</p>
<p><strong>phyloflows</strong> was primarily written to estimate transmission flows from counts of phylogenetically reconstructed likely transmission pairs, in whom the direction of transmission could be inferred with high support. Such input data can be obtained with <a href="https://github.com/BDI-pathogens/phyloscanner">phyloscanner</a>.</p>
<p>Different types of input data can also be used, so long as they represent observed counts of flow events from and to population sub-groups. Methodologically, in <strong>phyloflows</strong>, there is no limitation to deep-sequence phylogenetic data.</p>
<p>The primary feature of <strong>phyloflows</strong> is that the underlying statistical model allows adjusting for sampling heterogeneity across population groups while estimating transmission flows, a common problem in molecular epidemiologic analyses.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the latest development version from <strong>GitHub</strong>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">install_github</span>(<span class="st">"BDI-pathogens/phyloscanner/phyloflows"</span>, <span class="dt">dependencies=</span><span class="ot">TRUE</span>, <span class="dt">build_vignettes=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span>(phyloflows)</a></code></pre></div>
<p>If you have issues with installation/running of phyloflows, please raise an Issue on the GitHub page and we will get back to you.</p>
</div>
<div id="getting-started" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h2>
<p>If you are just getting started with <strong>phyloflows</strong>, please take a look at the sections below, and the tutorial vignettes at the bottom of this page.</p>
</div>
<div id="our-job" class="section level2">
<h2 class="hasAnchor">
<a href="#our-job" class="anchor"></a>Our job</h2>
<p>Suppose the true number of transmission flows between two population groups “1” and “2” is <span class="math display">\[
(z_{11}=50, z_{12}=10, z_{21}=20, z_{22}=20),
\]</span> so that the true proportion of transmission flows within and between groups is <span class="math display">\[
(\pi_{11}=0.5, \pi_{12}=0.1, \pi_{21}=0.2, \pi_{22}=0.2).
\]</span> <strong>The primary aim</strong> is to estimate the vector of proportions <span class="math inline">\(\pi=(\pi_{11},\pi_{12},\pi_{21},\pi_{22})\)</span>. This looks simple. <strong>However in real life one main complication is</strong> that only a proportion of the true transmission flows are observed (or sampled), and that the sampling probabilities differ. In our experience this situation not only occurs frequently in observational epidemiologic studies but also controlled situations (trials). Suppose that population “1” is sampled with probability <span class="math inline">\(s_1=0.6\)</span> and population “2” with probability <span class="math inline">\(s_2=1\)</span>. On expectation, we then observe the transmission flows <span class="math inline">\(n_{ij}= z_{ij} * s_i * s_j\)</span>, if we assume that sampling within and between the two groups is independent of each other, and if we ignore the fact that in reality sampling is without replacement. It won t matter much in reasonably large populations anyway, considering the extent of typical sampling differences. So what we observe is on expectation <span class="math display">\[
(n_{11}=18, n_{12}=6, n_{21}=12, n_{22}=20),
\]</span> If we don’t adjust for the sampling, a crude estimate of the true proportion of transmission flows would be <span class="math display">\[
(\hat{\pi}_{11}= 18/56= 0.321, \hat{\pi}_{12}=0.107, \hat{\pi}_{21}=0.214, \hat{\pi}_{22}=0.357)
\]</span> and the worst case error is <span class="math inline">\(50\%-32.1\%=17.9\%\)</span>. That is pretty bad. <strong>The job of phyloflow is to return better estimates</strong>, with a worst case error lower than 2-3%.</p>
</div>
<div id="our-solution" class="section level2">
<h2 class="hasAnchor">
<a href="#our-solution" class="anchor"></a>Our solution</h2>
<p>One very quick solution to the sampling problem would be to infer the actual transmission flows from what we know, i.e. <span class="math display">\[
\hat{z}_{ij}= n_{ij}/(s_i*s_j),
\]</span> and then to calculate <span class="math display">\[
\hat{\pi}_{ij}= \hat{z}_{ij} / \sum_{kl} \hat{z}_{kl}.
\]</span> But this does not address the further problems that the sampling groups may be different to the population groups between whom we want to infer transmission flows; that the sampling probabilities are usually not known themselves; and that we also want interpretable uncertainty estimates for <span class="math inline">\(\hat{\pi}\)</span>. So we use a Bayesian approach, and write down the likelihood of the complete data, <span class="math display">\[
p(z|Z,\pi)= Multinomial(z;Z,\pi),
\]</span> where <span class="math inline">\(Z\)</span> is the total number of transmissions, <span class="math inline">\(Z=\sum_{kl} z_{kl}\)</span>. Next, we add the likelihood of the sampling process, <span class="math display">\[
p(n_{ij}|z_{ij},s_i,s_j)= Binomial(n_{ij};z_{ij},s_i*s_j).
\]</span> Finally, we complete the model with prior distributions on the proportions, <span class="math inline">\(p(\pi)\)</span>, which we generally choose in an uninformative way; prior distributions on the sampling probabilities, <span class="math inline">\(p(s_i)\)</span>, which we generally choose based on other availabe information; and a prior distribution on the total number of transmissions, <span class="math inline">\(p(Z)\)</span>, which we also choose based on available information. And then we use Bayes Theorem.</p>
<p>This looks pretty straightforward. The issue is that in real-world data analyses, the total number of unknown parameters is 1,000 or even more. And so we also need a nifty computational inference engine. <strong>phyloflow</strong> uses a special type of Markov Chain Markov Carlo algorithms for this job. The main feature is that it has zero tuning variables, so the blame is 100% on us if it does not work. Just get in touch then.</p>
</div>
<div id="vignettes" class="section level2">
<h2 class="hasAnchor">
<a href="#vignettes" class="anchor"></a>Vignettes</h2>
<ol style="list-style-type: decimal">
<li><p><a href="articles/01_simulating_data.html">Simulating data.</a></p></li>
<li><p><a href="articles/02_basic_example.html">A very first example. Always start with me.</a></p></li>
<li><p><a href="articles/03_diagnostics.html">Performing MCMC diagnostic checks</a></p></li>
<li><p><a href="articles/04_aggregating.html">Aggregating MCMC output to a new set of variables</a></p></li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/BDI-pathogens/phyloscanner">https://​github.com/​BDI-pathogens/​phyloscanner</a>
</li>
<li>Report a bug at <br><a href="https://github.com/BDI-pathogens/phyloscanner/phyloflows/issues">https://​github.com/​BDI-pathogens/​phyloscanner/​phyloflows/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> </li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Xiaoyue Xi <br><small class="roles"> Author, maintainer </small>  </li>
<li>Oliver Ratmann <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Xiaoyue Xi, Oliver Ratmann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
