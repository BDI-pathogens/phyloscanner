<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Source attribution while sampling are structured under the GLM assumption • TransSubpopulation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Source attribution while sampling are structured under the GLM assumption">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TransSubpopulation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Source_attribution_under_GLM.html">Source attribution while sampling are structured under the GLM assumption</a>
    </li>
    <li>
      <a href="../articles/Source_attribution_under_SARWS_assumption.html">Source attribution while sampling are structured under the SARWS assumption</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Source attribution while sampling are structured under the GLM assumption</h1>
            
      
      
      <div class="hidden name"><code>Source_attribution_under_GLM.Rmd</code></div>

    </div>

    
    
<div id="simulating-sampling-data" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-sampling-data" class="anchor"></a>Simulating sampling data</h2>
<p>We start by simulating data required for this task. ‘dg’ is a data table containing the number of individuals who are eligible (<strong>TRIAL</strong>) and sampled (<strong>SUC</strong>) and covarites for each subpopulation (<strong>CATEGORY</strong>). Assume there are two locations where the numbers of infected individuals are 120 and 80.</p>
<p>Now we generate covariates for individuals (gender and age). Assume 70% infected individuals are women in location 1, among which 25%, 60% and 15% are aged 15-24, 25-34 and 35+; among men in location 1, 20%, 50% and 30% are aged 15-24, 25-34 and 35+. Assume 60% infected individuals are women in location 1, among which 25%, 50% and 25% are aged 15-24, 25-34 and 35+; among men in location 1, 20%, 40% and 40% are aged 15-24, 25-34 and 35+.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(data.table)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(gtools)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(TransSubpopulation)</a></code></pre></div>
<pre><code>## Warning: replacing previous import 'coda::traceplot' by 'rstan::traceplot'
## when loading 'TransSubpopulation'</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">dg&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/data.table">data.table</a></span>(<span class="dt">COMM_NUM_B=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span>,<span class="dv">120</span>),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">2</span>,<span class="dv">80</span>)),<span class="dt">INF=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span>,<span class="dv">200</span>))</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">num.f<span class="fl">.1</span>&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="dv">120</span><span class="op">*</span><span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">num.m<span class="fl">.1</span>&lt;-<span class="dv">120</span><span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="dv">120</span><span class="op">*</span><span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">num.f<span class="fl">.2</span>&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="dv">80</span><span class="op">*</span><span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">num.m<span class="fl">.2</span>&lt;-<span class="dv">80</span><span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="dv">80</span><span class="op">*</span><span class="fl">0.6</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">dg<span class="op">$</span>SEX&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'F'</span>,num.f<span class="fl">.1</span>),</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">          <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'M'</span>,num.m<span class="fl">.1</span>),</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">          <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'F'</span>,num.f<span class="fl">.2</span>),</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">          <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'M'</span>,num.m<span class="fl">.2</span>))</a>
<a class="sourceLine" id="cb3-12" data-line-number="12">dg<span class="op">$</span>AGE_AT_MID_C&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'15-24'</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.f<span class="fl">.1</span><span class="op">*</span><span class="fl">0.25</span>)),</a>
<a class="sourceLine" id="cb3-13" data-line-number="13">                   <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'25-34'</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.f<span class="fl">.1</span><span class="op">*</span><span class="fl">0.6</span>)),</a>
<a class="sourceLine" id="cb3-14" data-line-number="14">                   <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'35+'</span>,num.f<span class="fl">.1</span><span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.f<span class="fl">.1</span><span class="op">*</span><span class="fl">0.25</span>)<span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.f<span class="fl">.1</span><span class="op">*</span><span class="fl">0.6</span>)),</a>
<a class="sourceLine" id="cb3-15" data-line-number="15">                   <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'15-24'</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.m<span class="fl">.1</span><span class="op">*</span><span class="fl">0.2</span>)),</a>
<a class="sourceLine" id="cb3-16" data-line-number="16">                   <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'25-34'</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.m<span class="fl">.1</span><span class="op">*</span><span class="fl">0.5</span>)),</a>
<a class="sourceLine" id="cb3-17" data-line-number="17">                   <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'35+'</span>,num.m<span class="fl">.1</span><span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.m<span class="fl">.1</span><span class="op">*</span><span class="fl">0.2</span>)<span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.m<span class="fl">.1</span><span class="op">*</span><span class="fl">0.5</span>)),</a>
<a class="sourceLine" id="cb3-18" data-line-number="18">                   <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'15-24'</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.f<span class="fl">.2</span><span class="op">*</span><span class="fl">0.25</span>)),</a>
<a class="sourceLine" id="cb3-19" data-line-number="19">                   <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'25-34'</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.f<span class="fl">.2</span><span class="op">*</span><span class="fl">0.5</span>)),</a>
<a class="sourceLine" id="cb3-20" data-line-number="20">                   <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'35+'</span>,num.f<span class="fl">.2</span><span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.f<span class="fl">.2</span><span class="op">*</span><span class="fl">0.25</span>)<span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.f<span class="fl">.2</span><span class="op">*</span><span class="fl">0.5</span>)),</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">                   <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'15-24'</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.m<span class="fl">.2</span><span class="op">*</span><span class="fl">0.2</span>)),</a>
<a class="sourceLine" id="cb3-22" data-line-number="22">                   <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'25-34'</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.m<span class="fl">.2</span><span class="op">*</span><span class="fl">0.4</span>)),</a>
<a class="sourceLine" id="cb3-23" data-line-number="23">                   <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">'35+'</span>,num.m<span class="fl">.2</span><span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.m<span class="fl">.2</span><span class="op">*</span><span class="fl">0.2</span>)<span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(num.m<span class="fl">.2</span><span class="op">*</span><span class="fl">0.4</span>))</a>
<a class="sourceLine" id="cb3-24" data-line-number="24">                   )</a></code></pre></div>
<p>Based on these covariates, we compute the number of infected individuals <span class="math inline">\(X_a^i\)</span> in each subpopulation stratified by age, gender and locations. Assume regression coefficients as follows:</p>
<ol style="list-style-type: decimal">
<li>intercept: 0.4</li>
<li>varying intercepts for location 1 and 2: 0.5,-0.5</li>
<li>regression coefficients for the variables ‘being male’, ‘being young’ and ‘being mid-age’ are 0.4, 0.3 and 0.2.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">dg      &lt;-<span class="st"> </span>dg[, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">TRIAL=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(INF)),by=<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'AGE_AT_MID_C'</span>,<span class="st">'SEX'</span>,<span class="st">'COMM_NUM_B'</span>)]</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">comm&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">a&lt;-<span class="fl">0.4</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">male&lt;-<span class="fl">0.4</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">young&lt;-<span class="fl">0.3</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">midage&lt;-<span class="fl">0.2</span></a></code></pre></div>
<p>Age and genders are then binarised for regression covariates which are then used to evaluate the sampling rate of group a <span class="math inline">\(\mbox{logit}(\xi_a)\)</span>. Based on <span class="math inline">\(\xi_a\)</span>, the number of individuals being sequenced <span class="math inline">\(X_a^s\)</span> is generated by a Binomial distribution <span class="math inline">\(\mbox{Binomial}(X_a^i,\xi_a)\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">dg[, AGE1<span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/integer">as.integer</a></span>(AGE_AT_MID_C<span class="op">==</span><span class="st">'15-24'</span>)]</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">dg[, AGE2<span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/integer">as.integer</a></span>(AGE_AT_MID_C<span class="op">==</span><span class="st">'25-34'</span>)]</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">dg[, MALE<span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/integer">as.integer</a></span>(SEX<span class="op">==</span><span class="st">'M'</span>)]</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">dg[,LOGIT_P_SEQ<span class="op">:</span><span class="er">=</span>a <span class="op">+</span><span class="st"> </span>comm[COMM_NUM_B] <span class="op">+</span><span class="st"> </span>male<span class="op">*</span>MALE <span class="op">+</span><span class="st"> </span>young<span class="op">*</span>AGE1 <span class="op">+</span><span class="st"> </span>midage<span class="op">*</span>AGE2]</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">dg[,P_SEQ<span class="op">:</span><span class="er">=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">exp</a></span>(LOGIT_P_SEQ)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">exp</a></span>(LOGIT_P_SEQ))]</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">dg[,SUC<span class="op">:</span><span class="er">=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">rbinom</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(dg),TRIAL,P_SEQ)]</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">dg[,CATEGORY<span class="op">:</span><span class="er">=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(COMM_NUM_B,<span class="st">':'</span>,SEX,<span class="st">':'</span>,AGE_AT_MID_C)]</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">dg[,COMM_NUM_B<span class="op">:</span><span class="er">=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/integer">as.integer</a></span>(COMM_NUM_B)]</a></code></pre></div>
</div>
<div id="simulating-transmission-data" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-transmission-data" class="anchor"></a>Simulating transmission data</h2>
<p>‘dc’ is created by all ordered combination of subpopulations in ‘dg’ and only heterosexual transmission pairs are kept.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">dc&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/as.data.table">as.data.table</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expand.grid">expand.grid</a></span>(<span class="dt">TR_CATEGORY=</span>dg<span class="op">$</span>CATEGORY,<span class="dt">REC_CATEGORY=</span>dg<span class="op">$</span>CATEGORY))</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">dc[,COUNT_ID<span class="op">:</span><span class="er">=</span><span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(dc)]</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">dc[, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"TR_COMM_NUM_B"</span>,<span class="st">"TR_SEX"</span>, <span class="st">"TR_AGE_AT_MID_C"</span>) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/tstrsplit">tstrsplit</a></span>(TR_CATEGORY, <span class="st">":"</span>, <span class="dt">fixed=</span><span class="ot">TRUE</span>)]</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">dc[, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"REC_COMM_NUM_B"</span>,<span class="st">"REC_SEX"</span>, <span class="st">"REC_AGE_AT_MID_C"</span>) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/tstrsplit">tstrsplit</a></span>(REC_CATEGORY, <span class="st">":"</span>, <span class="dt">fixed=</span><span class="ot">TRUE</span>)]</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">dc&lt;-dc[TR_SEX<span class="op">!=</span>REC_SEX,]</a></code></pre></div>
<p>Assume transmissions are less likely to occur between different locations, to elder individuals in male-female transmissions and to younger individuals in female-male transmissions. Dirichlet hyperparameters are set to be around 1 for these less probable pairs and around 2 for the rest of pairs. The probabilities of transmissions between subpopulations are then given by the mean of the Dirichlet distribution.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">lbd&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="ot">NA_real_</span>,<span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">ncol =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(dc))</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(dc)){</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="cf">if</span> (dc<span class="op">$</span>TR_COMM_NUM_B[i]<span class="op">==</span>dc<span class="op">$</span>REC_COMM_NUM_B[i]){</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">    <span class="cf">if</span> ( (dc<span class="op">$</span>TR_AGE_AT_MID_C[i]<span class="op">==</span><span class="st">'15-24'</span> <span class="op">&amp;</span><span class="st"> </span>dc<span class="op">$</span>REC_AGE_AT_MID_C[i]<span class="op">==</span><span class="st">'25-34'</span>) <span class="op">|</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="st">         </span>(dc<span class="op">$</span>TR_AGE_AT_MID_C[i]<span class="op">==</span><span class="st">'15-24'</span> <span class="op">&amp;</span><span class="st"> </span>dc<span class="op">$</span>REC_AGE_AT_MID_C[i]<span class="op">==</span><span class="st">'35+'</span>) <span class="op">|</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="st">         </span>(dc<span class="op">$</span>TR_AGE_AT_MID_C[i]<span class="op">==</span><span class="st">'25-34'</span> <span class="op">&amp;</span><span class="st"> </span>dc<span class="op">$</span>REC_AGE_AT_MID_C[i]<span class="op">==</span><span class="st">'35+'</span>)){</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">      <span class="cf">if</span> (dc<span class="op">$</span>TR_SEX[i]<span class="op">==</span><span class="st">'M'</span>){</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">        lbd[i]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">      }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">        lbd[i]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">      }</a>
<a class="sourceLine" id="cb7-12" data-line-number="12">    }<span class="cf">else</span> <span class="cf">if</span> ( (dc<span class="op">$</span>REC_AGE_AT_MID_C[i]<span class="op">==</span><span class="st">'15-24'</span> <span class="op">&amp;</span><span class="st"> </span>dc<span class="op">$</span>TR_AGE_AT_MID_C[i]<span class="op">==</span><span class="st">'25-34'</span>) <span class="op">|</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="st">               </span>(dc<span class="op">$</span>REC_AGE_AT_MID_C[i]<span class="op">==</span><span class="st">'15-24'</span> <span class="op">&amp;</span><span class="st"> </span>dc<span class="op">$</span>TR_AGE_AT_MID_C[i]<span class="op">==</span><span class="st">'35+'</span>) <span class="op">|</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="st">               </span>(dc<span class="op">$</span>REC_AGE_AT_MID_C[i]<span class="op">==</span><span class="st">'25-34'</span> <span class="op">&amp;</span><span class="st"> </span>dc<span class="op">$</span>TR_AGE_AT_MID_C[i]<span class="op">==</span><span class="st">'35+'</span>)){</a>
<a class="sourceLine" id="cb7-15" data-line-number="15">      <span class="cf">if</span> (dc<span class="op">$</span>TR_SEX[i]<span class="op">==</span><span class="st">'M'</span>){</a>
<a class="sourceLine" id="cb7-16" data-line-number="16">        lbd[i]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb7-17" data-line-number="17">      }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb7-18" data-line-number="18">        lbd[i]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb7-19" data-line-number="19">      }</a>
<a class="sourceLine" id="cb7-20" data-line-number="20">    }<span class="cf">else</span> <span class="cf">if</span>(dc<span class="op">$</span>TR_AGE_AT_MID_C[i]<span class="op">==</span>dc<span class="op">$</span>REC_AGE_AT_MID_C[i]){</a>
<a class="sourceLine" id="cb7-21" data-line-number="21">      lbd[i]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb7-22" data-line-number="22">    }</a>
<a class="sourceLine" id="cb7-23" data-line-number="23">  }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb7-24" data-line-number="24">    lbd[i]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb7-25" data-line-number="25">  }</a>
<a class="sourceLine" id="cb7-26" data-line-number="26">}</a>
<a class="sourceLine" id="cb7-27" data-line-number="27">TRUE_PI&lt;-lbd<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(lbd)</a>
<a class="sourceLine" id="cb7-28" data-line-number="28">dc[,TRUE_PI<span class="op">:</span><span class="er">=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/vector">as.vector</a></span>(TRUE_PI)]</a></code></pre></div>
<p>Here presented the assymmetric transmission matrix</p>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">1:F:15-24</th>
<th align="right">1:F:25-34</th>
<th align="right">1:F:35+</th>
<th align="right">1:M:15-24</th>
<th align="right">1:M:25-34</th>
<th align="right">1:M:35+</th>
<th align="right">2:F:15-24</th>
<th align="right">2:F:25-34</th>
<th align="right">2:F:35+</th>
<th align="right">2:M:15-24</th>
<th align="right">2:M:25-34</th>
<th align="right">2:M:35+</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1:F:15-24</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0196</td>
<td align="right">0.0218</td>
<td align="right">0.0220</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0112</td>
<td align="right">0.0114</td>
<td align="right">0.0125</td>
</tr>
<tr class="even">
<td>1:F:25-34</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0069</td>
<td align="right">0.0203</td>
<td align="right">0.0208</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0094</td>
<td align="right">0.0106</td>
<td align="right">0.0090</td>
</tr>
<tr class="odd">
<td>1:F:35+</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0122</td>
<td align="right">0.0123</td>
<td align="right">0.0202</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0097</td>
<td align="right">0.0124</td>
<td align="right">0.0090</td>
</tr>
<tr class="even">
<td>1:M:15-24</td>
<td align="right">0.0218</td>
<td align="right">0.0113</td>
<td align="right">0.0119</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0078</td>
<td align="right">0.0121</td>
<td align="right">0.0100</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td>1:M:25-34</td>
<td align="right">0.0182</td>
<td align="right">0.0211</td>
<td align="right">0.0095</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0150</td>
<td align="right">0.0103</td>
<td align="right">0.0136</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td>1:M:35+</td>
<td align="right">0.0195</td>
<td align="right">0.0197</td>
<td align="right">0.0187</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0130</td>
<td align="right">0.0110</td>
<td align="right">0.0072</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td>2:F:15-24</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0108</td>
<td align="right">0.0123</td>
<td align="right">0.0096</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0188</td>
<td align="right">0.0252</td>
<td align="right">0.0230</td>
</tr>
<tr class="even">
<td>2:F:25-34</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0081</td>
<td align="right">0.0122</td>
<td align="right">0.0090</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0082</td>
<td align="right">0.0199</td>
<td align="right">0.0203</td>
</tr>
<tr class="odd">
<td>2:F:35+</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0131</td>
<td align="right">0.0119</td>
<td align="right">0.0100</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0111</td>
<td align="right">0.0056</td>
<td align="right">0.0183</td>
</tr>
<tr class="even">
<td>2:M:15-24</td>
<td align="right">0.0095</td>
<td align="right">0.0142</td>
<td align="right">0.0100</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0185</td>
<td align="right">0.0104</td>
<td align="right">0.0117</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td>2:M:25-34</td>
<td align="right">0.0130</td>
<td align="right">0.0115</td>
<td align="right">0.0083</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0200</td>
<td align="right">0.0208</td>
<td align="right">0.0107</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td>2:M:35+</td>
<td align="right">0.0112</td>
<td align="right">0.0063</td>
<td align="right">0.0089</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0199</td>
<td align="right">0.0237</td>
<td align="right">0.0213</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
</tr>
</tbody>
</table>
<p>Predicted sequencing rates for each subpopulation in ‘dg’ are used to evaluate the probability of a transmission between two subpopulations being observed.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">tmp&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/subset.data.table">subset</a></span>(dg,<span class="dt">select=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'CATEGORY'</span>,<span class="st">'P_SEQ'</span>))</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/setattr">setnames</a></span>(tmp,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(tmp),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">'TR_'</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(tmp)))</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">dc&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/merge">merge</a></span>(dc,tmp,<span class="dt">by=</span><span class="st">'TR_CATEGORY'</span>)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/setattr">setnames</a></span>(tmp,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(tmp),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">gsub</a></span>(<span class="st">'TR_'</span>,<span class="st">'REC_'</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(tmp)))</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">dc&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/merge">merge</a></span>(dc,tmp,<span class="dt">by=</span><span class="st">'REC_CATEGORY'</span>)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">dc[,S<span class="op">:</span><span class="er">=</span>TR_P_SEQ<span class="op">*</span>REC_P_SEQ]</a></code></pre></div>
<p>Assume the observed transmission count is 20, and the observed transmissions between subpopulations could be simulated as follows:</p>
<ol style="list-style-type: decimal">
<li>generate the true transmission count <span class="math inline">\(Z \sim \mbox{Poisson} (20/S)\)</span>
</li>
<li>generate the true transmissions between groups <span class="math inline">\(z \sim \mbox{Multinomial} (Z,\pi)\)</span>
</li>
<li>generate the observed transmissions between groups <span class="math inline">\(n_{ab} \sim \mbox{Binomial} (z_{ab},\vartheta_{ab}), \forall a,b\)</span>
</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">N&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Poisson">rpois</a></span>(<span class="dv">1</span>,<span class="dv">20</span><span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(dc<span class="op">$</span>S))</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">z&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Multinom">rmultinom</a></span>(<span class="dv">1</span>,<span class="dt">size=</span>N,<span class="dt">prob=</span>TRUE_PI)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">n&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="ot">NA_integer_</span>,<span class="dt">ncol=</span><span class="dv">1</span>,<span class="dt">nrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(TRUE_PI))</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(TRUE_PI)){</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  n[i]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">rbinom</a></span>(<span class="dv">1</span>,<span class="dt">size=</span>z[i],dc<span class="op">$</span>S[i])</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">}</a></code></pre></div>
<p>Observed transmissions between groups are recorded from the simulation and id numbers are set for the stratified transmissions.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">dc<span class="op">$</span>OBS&lt;-n</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">dc.obs.zero&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(dc<span class="op">$</span>OBS<span class="op">==</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">dc&lt;-dc[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(dc<span class="op">$</span>OBS<span class="op">!=</span><span class="dv">0</span>),]</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">dc<span class="op">$</span>COUNT_ID&lt;-<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(dc)</a>
<a class="sourceLine" id="cb10-5" data-line-number="5"></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co"># remove irrelevant terms</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7">dg<span class="op">$</span>P_SEQ&lt;-<span class="ot">NULL</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8">dg<span class="op">$</span>LOGIT_P_SEQ&lt;-<span class="ot">NULL</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9">dc<span class="op">$</span>TR_P_SEQ&lt;-<span class="ot">NULL</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10">dc<span class="op">$</span>REC_P_SEQ&lt;-<span class="ot">NULL</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11">dc<span class="op">$</span>S&lt;-<span class="ot">NULL</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12">dc<span class="op">$</span>TRUE_PI&lt;-<span class="ot">NULL</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13">dc[,TR_COMM_NUM_B<span class="op">:</span><span class="er">=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/integer">as.integer</a></span>(TR_COMM_NUM_B)]</a>
<a class="sourceLine" id="cb10-14" data-line-number="14">dc[,REC_COMM_NUM_B<span class="op">:</span><span class="er">=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/integer">as.integer</a></span>(REC_COMM_NUM_B)]</a></code></pre></div>
<p>‘df.sampling’ is a list of data table composed of ‘dg’.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">df.sampling&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>()</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">df.sampling[[<span class="dv">1</span>]]&lt;-dg</a></code></pre></div>
<p>Here we present the form of the inputs of prior generator under GLM, i.e. <strong>df.sampling</strong> and <strong>dc</strong>.</p>
<table class="table">
<caption>df.sampling[[1]]</caption>
<thead><tr class="header">
<th align="left">AGE_AT_MID_C</th>
<th align="left">SEX</th>
<th align="right">COMM_NUM_B</th>
<th align="right">TRIAL</th>
<th align="right">AGE1</th>
<th align="right">AGE2</th>
<th align="right">MALE</th>
<th align="right">SUC</th>
<th align="left">CATEGORY</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">15-24</td>
<td align="left">F</td>
<td align="right">1</td>
<td align="right">21</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">17</td>
<td align="left">1:F:15-24</td>
</tr>
<tr class="even">
<td align="left">25-34</td>
<td align="left">F</td>
<td align="right">1</td>
<td align="right">50</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">35</td>
<td align="left">1:F:25-34</td>
</tr>
<tr class="odd">
<td align="left">35+</td>
<td align="left">F</td>
<td align="right">1</td>
<td align="right">13</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="left">1:F:35+</td>
</tr>
<tr class="even">
<td align="left">15-24</td>
<td align="left">M</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="left">1:M:15-24</td>
</tr>
<tr class="odd">
<td align="left">25-34</td>
<td align="left">M</td>
<td align="right">1</td>
<td align="right">18</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">12</td>
<td align="left">1:M:25-34</td>
</tr>
<tr class="even">
<td align="left">35+</td>
<td align="left">M</td>
<td align="right">1</td>
<td align="right">11</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">11</td>
<td align="left">1:M:35+</td>
</tr>
<tr class="odd">
<td align="left">15-24</td>
<td align="left">F</td>
<td align="right">2</td>
<td align="right">12</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="left">2:F:15-24</td>
</tr>
<tr class="even">
<td align="left">25-34</td>
<td align="left">F</td>
<td align="right">2</td>
<td align="right">24</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="left">2:F:25-34</td>
</tr>
<tr class="odd">
<td align="left">35+</td>
<td align="left">F</td>
<td align="right">2</td>
<td align="right">12</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="left">2:F:35+</td>
</tr>
<tr class="even">
<td align="left">15-24</td>
<td align="left">M</td>
<td align="right">2</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="left">2:M:15-24</td>
</tr>
<tr class="odd">
<td align="left">25-34</td>
<td align="left">M</td>
<td align="right">2</td>
<td align="right">13</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="left">2:M:25-34</td>
</tr>
<tr class="even">
<td align="left">35+</td>
<td align="left">M</td>
<td align="right">2</td>
<td align="right">13</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">8</td>
<td align="left">2:M:35+</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>dc</caption>
<thead><tr class="header">
<th align="left">REC_CATEGORY</th>
<th align="left">TR_CATEGORY</th>
<th align="right">COUNT_ID</th>
<th align="right">TR_COMM_NUM_B</th>
<th align="left">TR_SEX</th>
<th align="left">TR_AGE_AT_MID_C</th>
<th align="right">REC_COMM_NUM_B</th>
<th align="left">REC_SEX</th>
<th align="left">REC_AGE_AT_MID_C</th>
<th align="right">OBS</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1:F:25-34</td>
<td align="left">1:M:25-34</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">M</td>
<td align="left">25-34</td>
<td align="right">1</td>
<td align="left">F</td>
<td align="left">25-34</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">1:F:25-34</td>
<td align="left">1:M:35+</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">M</td>
<td align="left">35+</td>
<td align="right">1</td>
<td align="left">F</td>
<td align="left">25-34</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">1:F:35+</td>
<td align="left">1:M:15-24</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="left">M</td>
<td align="left">15-24</td>
<td align="right">1</td>
<td align="left">F</td>
<td align="left">35+</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">1:F:35+</td>
<td align="left">1:M:35+</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="left">M</td>
<td align="left">35+</td>
<td align="right">1</td>
<td align="left">F</td>
<td align="left">35+</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">1:M:25-34</td>
<td align="left">1:F:15-24</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="left">F</td>
<td align="left">15-24</td>
<td align="right">1</td>
<td align="left">M</td>
<td align="left">25-34</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">1:M:25-34</td>
<td align="left">1:F:35+</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="left">F</td>
<td align="left">35+</td>
<td align="right">1</td>
<td align="left">M</td>
<td align="left">25-34</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">1:M:25-34</td>
<td align="left">2:F:35+</td>
<td align="right">7</td>
<td align="right">2</td>
<td align="left">F</td>
<td align="left">35+</td>
<td align="right">1</td>
<td align="left">M</td>
<td align="left">25-34</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">1:M:35+</td>
<td align="left">1:F:15-24</td>
<td align="right">8</td>
<td align="right">1</td>
<td align="left">F</td>
<td align="left">15-24</td>
<td align="right">1</td>
<td align="left">M</td>
<td align="left">35+</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">1:M:35+</td>
<td align="left">1:F:25-34</td>
<td align="right">9</td>
<td align="right">1</td>
<td align="left">F</td>
<td align="left">25-34</td>
<td align="right">1</td>
<td align="left">M</td>
<td align="left">35+</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2:F:15-24</td>
<td align="left">1:M:15-24</td>
<td align="right">10</td>
<td align="right">1</td>
<td align="left">M</td>
<td align="left">15-24</td>
<td align="right">2</td>
<td align="left">F</td>
<td align="left">15-24</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">2:F:15-24</td>
<td align="left">2:M:35+</td>
<td align="right">11</td>
<td align="right">2</td>
<td align="left">M</td>
<td align="left">35+</td>
<td align="right">2</td>
<td align="left">F</td>
<td align="left">15-24</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2:F:25-34</td>
<td align="left">1:M:25-34</td>
<td align="right">12</td>
<td align="right">1</td>
<td align="left">M</td>
<td align="left">25-34</td>
<td align="right">2</td>
<td align="left">F</td>
<td align="left">25-34</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">2:F:25-34</td>
<td align="left">1:M:35+</td>
<td align="right">13</td>
<td align="right">1</td>
<td align="left">M</td>
<td align="left">35+</td>
<td align="right">2</td>
<td align="left">F</td>
<td align="left">25-34</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2:M:15-24</td>
<td align="left">1:F:25-34</td>
<td align="right">14</td>
<td align="right">1</td>
<td align="left">F</td>
<td align="left">25-34</td>
<td align="right">2</td>
<td align="left">M</td>
<td align="left">15-24</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">2:M:25-34</td>
<td align="left">1:F:15-24</td>
<td align="right">15</td>
<td align="right">1</td>
<td align="left">F</td>
<td align="left">15-24</td>
<td align="right">2</td>
<td align="left">M</td>
<td align="left">25-34</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2:M:25-34</td>
<td align="left">1:F:25-34</td>
<td align="right">16</td>
<td align="right">1</td>
<td align="left">F</td>
<td align="left">25-34</td>
<td align="right">2</td>
<td align="left">M</td>
<td align="left">25-34</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">2:M:35+</td>
<td align="left">2:F:15-24</td>
<td align="right">17</td>
<td align="right">2</td>
<td align="left">F</td>
<td align="left">15-24</td>
<td align="right">2</td>
<td align="left">M</td>
<td align="left">35+</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2:M:35+</td>
<td align="left">2:F:25-34</td>
<td align="right">18</td>
<td align="right">2</td>
<td align="left">F</td>
<td align="left">25-34</td>
<td align="right">2</td>
<td align="left">M</td>
<td align="left">35+</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">2:M:35+</td>
<td align="left">2:F:35+</td>
<td align="right">19</td>
<td align="right">2</td>
<td align="left">F</td>
<td align="left">35+</td>
<td align="right">2</td>
<td align="left">M</td>
<td align="left">35+</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div id="implementing-the-bias-adjusted-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#implementing-the-bias-adjusted-algorithm" class="anchor"></a>Implementing the bias-adjusted algorithm</h2>
<p>We now draw samples from the prior distribution using GLM. The function will depend on covariates and the function ‘samples.from.GLM.prior’ from this package is an example. Running the following lines gives you information required for MCMC algorithm, i.e. S.DTL.prior and TR.OBS and save data under your working directory.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/samples.from.GLM.prior.html">samples.from.GLM.prior</a></span>(<span class="dt">df.sampling=</span>df.sampling,<span class="dt">dc=</span>dc,<span class="dt">iteration=</span><span class="fl">3e6</span>,<span class="dt">sample.method=</span><span class="st">'empirical'</span>,<span class="dt">glm.model=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'binomial'</span>),<span class="dt">seed=</span><span class="dv">123</span>)</a></code></pre></div>
<p>After loading the samples from the prior distribution, we can use the following algorithm to estimate the proportion of transmissions between subpopulations when correcting for sampling differences.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/mcmc.core.inference.html">mcmc.core.inference</a></span>(<span class="dt">s.dtl.prior=</span>S.DTL.prior,<span class="dt">tr.obs=</span>TR.OBS,<span class="dt">seed=</span><span class="dv">123</span>)</a></code></pre></div>
<p>The estimated proportions of transmissions between subpopulations are summerised as follows.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># runtime of the algorithm</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(time)</a></code></pre></div>
<pre><code>## Time difference of 49.85022 mins</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">dc.obs.nonzero&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/setops">setdiff</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(TRUE_PI),dc.obs.zero)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">PI.summary&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/data.table">data.table</a></span>(<span class="dt">PI_MEDIAN=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(TRUE_PI)),</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">                       <span class="dt">PI_LOWER=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(TRUE_PI)),</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">                       <span class="dt">PI_UPPER=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(TRUE_PI)),</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">                       <span class="dt">PI_TRUE=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/vector">as.vector</a></span>(TRUE_PI),</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">                       <span class="dt">ID=</span><span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(TRUE_PI))</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">PI.summary<span class="op">$</span>PI_MEDIAN[dc.obs.nonzero]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(mc<span class="op">$</span>pars<span class="op">$</span>PI,<span class="dv">2</span>,median)</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">PI.summary<span class="op">$</span>PI_LOWER[dc.obs.nonzero]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(mc<span class="op">$</span>pars<span class="op">$</span>PI,<span class="dv">2</span>,<span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(x,<span class="fl">0.025</span>)})</a>
<a class="sourceLine" id="cb16-9" data-line-number="9">PI.summary<span class="op">$</span>PI_UPPER[dc.obs.nonzero]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(mc<span class="op">$</span>pars<span class="op">$</span>PI,<span class="dv">2</span>,<span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(x,<span class="fl">0.975</span>)})</a></code></pre></div>
<table class="table">
<caption>summary of PI</caption>
<thead><tr class="header">
<th align="right">PI_MEDIAN</th>
<th align="right">PI_LOWER</th>
<th align="right">PI_UPPER</th>
<th align="right">PI_TRUE</th>
<th align="right">ID</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0218476</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0182429</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0194505</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0095117</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0129990</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0111940</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0112795</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">0.0254253</td>
<td align="right">0.0010599</td>
<td align="right">0.1286620</td>
<td align="right">0.0211161</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">0.0228927</td>
<td align="right">0.0009390</td>
<td align="right">0.1156312</td>
<td align="right">0.0197241</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0141744</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0114822</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0063352</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="right">0.0208898</td>
<td align="right">0.0008646</td>
<td align="right">0.1060462</td>
<td align="right">0.0119073</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0094551</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="right">0.0202265</td>
<td align="right">0.0008113</td>
<td align="right">0.1020357</td>
<td align="right">0.0186548</td>
<td align="right">15</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0099872</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0082997</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0089202</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0195796</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0069198</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0121922</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0107628</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0080655</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0130611</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">0.0231217</td>
<td align="right">0.0009389</td>
<td align="right">0.1170760</td>
<td align="right">0.0217756</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0202687</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="right">0.0232122</td>
<td align="right">0.0009536</td>
<td align="right">0.1184109</td>
<td align="right">0.0123119</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0122765</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0121584</td>
<td align="right">29</td>
</tr>
<tr class="even">
<td align="right">0.0295577</td>
<td align="right">0.0012147</td>
<td align="right">0.1530335</td>
<td align="right">0.0118807</td>
<td align="right">30</td>
</tr>
<tr class="odd">
<td align="right">0.0812396</td>
<td align="right">0.0191991</td>
<td align="right">0.2115953</td>
<td align="right">0.0220418</td>
<td align="right">31</td>
</tr>
<tr class="even">
<td align="right">0.0232333</td>
<td align="right">0.0009603</td>
<td align="right">0.1179582</td>
<td align="right">0.0207557</td>
<td align="right">32</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0202460</td>
<td align="right">33</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0096479</td>
<td align="right">34</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0089916</td>
<td align="right">35</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0100082</td>
<td align="right">36</td>
</tr>
<tr class="odd">
<td align="right">0.0290112</td>
<td align="right">0.0011838</td>
<td align="right">0.1500994</td>
<td align="right">0.0077997</td>
<td align="right">37</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0149723</td>
<td align="right">38</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0129653</td>
<td align="right">39</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0185394</td>
<td align="right">40</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0200435</td>
<td align="right">41</td>
</tr>
<tr class="even">
<td align="right">0.0337314</td>
<td align="right">0.0013732</td>
<td align="right">0.1738769</td>
<td align="right">0.0199104</td>
<td align="right">42</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0120714</td>
<td align="right">43</td>
</tr>
<tr class="even">
<td align="right">0.1001121</td>
<td align="right">0.0149018</td>
<td align="right">0.2991336</td>
<td align="right">0.0102684</td>
<td align="right">44</td>
</tr>
<tr class="odd">
<td align="right">0.0365738</td>
<td align="right">0.0014877</td>
<td align="right">0.1807646</td>
<td align="right">0.0109715</td>
<td align="right">45</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0103829</td>
<td align="right">46</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0207954</td>
<td align="right">47</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0237433</td>
<td align="right">48</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0099710</td>
<td align="right">49</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0136096</td>
<td align="right">50</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0072079</td>
<td align="right">51</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0116634</td>
<td align="right">52</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0107012</td>
<td align="right">53</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0213360</td>
<td align="right">54</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0112354</td>
<td align="right">55</td>
</tr>
<tr class="even">
<td align="right">0.0352941</td>
<td align="right">0.0014516</td>
<td align="right">0.1756738</td>
<td align="right">0.0093934</td>
<td align="right">56</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0097466</td>
<td align="right">57</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0187577</td>
<td align="right">58</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0082040</td>
<td align="right">59</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0110764</td>
<td align="right">60</td>
</tr>
<tr class="odd">
<td align="right">0.0351082</td>
<td align="right">0.0014369</td>
<td align="right">0.1769355</td>
<td align="right">0.0113786</td>
<td align="right">61</td>
</tr>
<tr class="even">
<td align="right">0.1085140</td>
<td align="right">0.0167311</td>
<td align="right">0.3143462</td>
<td align="right">0.0105532</td>
<td align="right">62</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0123686</td>
<td align="right">63</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0251666</td>
<td align="right">64</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0198594</td>
<td align="right">65</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0056198</td>
<td align="right">66</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0125430</td>
<td align="right">67</td>
</tr>
<tr class="even">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0089613</td>
<td align="right">68</td>
</tr>
<tr class="odd">
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0090056</td>
<td align="right">69</td>
</tr>
<tr class="even">
<td align="right">0.0350984</td>
<td align="right">0.0014260</td>
<td align="right">0.1776609</td>
<td align="right">0.0230269</td>
<td align="right">70</td>
</tr>
<tr class="odd">
<td align="right">0.0443699</td>
<td align="right">0.0018305</td>
<td align="right">0.2154691</td>
<td align="right">0.0202902</td>
<td align="right">71</td>
</tr>
<tr class="even">
<td align="right">0.0393753</td>
<td align="right">0.0016439</td>
<td align="right">0.1888486</td>
<td align="right">0.0183355</td>
<td align="right">72</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># runtime of the algorithm</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(time)</a></code></pre></div>
<pre><code>## Time difference of 49.85022 mins</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">dc.obs.nonzero&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/setops">setdiff</a></span>(<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(TRUE_PI),dc.obs.zero)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">PI.summary&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/data.table">data.table</a></span>(<span class="dt">PI_MEDIAN=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(TRUE_PI)),</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">                       <span class="dt">PI_LOWER=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(TRUE_PI)),</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">                       <span class="dt">PI_UPPER=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(TRUE_PI)),</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">                       <span class="dt">PI_TRUE=</span>TRUE_PI,</a>
<a class="sourceLine" id="cb19-6" data-line-number="6">                       <span class="dt">ID=</span><span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(TRUE_PI))</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">PI.summary<span class="op">$</span>PI_MEDIAN[dc.obs.nonzero]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(mc<span class="op">$</span>pars<span class="op">$</span>PI,<span class="dv">2</span>,median)</a>
<a class="sourceLine" id="cb19-8" data-line-number="8">PI.summary<span class="op">$</span>PI_LOWER[dc.obs.nonzero]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(mc<span class="op">$</span>pars<span class="op">$</span>PI,<span class="dv">2</span>,<span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(x,<span class="fl">0.025</span>)})</a>
<a class="sourceLine" id="cb19-9" data-line-number="9">PI.summary<span class="op">$</span>PI_UPPER[dc.obs.nonzero]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(mc<span class="op">$</span>pars<span class="op">$</span>PI,<span class="dv">2</span>,<span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(x,<span class="fl">0.975</span>)})</a></code></pre></div>
<p>If you want to visualise MCMC convergence diagnostics, you may use the function ‘mcmc.core.inference.diagnostics’ and all the results are saved in your computer.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="../reference/mcmc.core.inference.diagnostics.html">mcmc.core.inference.diagnostics</a></span>(mc,<span class="fl">2e3</span>)</a></code></pre></div>
<pre><code>## [1] "The worst effective sample sizes for PI 18 are 27728.4099374372 out of 228771 samples."
## [2] "The worst effective sample sizes for PI 16 are 28120.6026583684 out of 228771 samples."
## [3] "The worst effective sample sizes for PI 19 are 31373.1828815832 out of 228771 samples."
## [4] "The worst effective sample sizes for PI 13 are 40189.6158377538 out of 228771 samples."
## [5] "The worst effective sample sizes for PI 17 are 42673.6920435542 out of 228771 samples."
## [6] "The worst effective sample sizes for PI 12 are 44061.1190861027 out of 228771 samples."</code></pre>
<pre><code>## [1] "The worst effective sample sizes for S are 16 are 96735.8604588647 out of 228771 samples."
## [2] "The worst effective sample sizes for S are 13 are 96853.9902559319 out of 228771 samples."
## [3] "The worst effective sample sizes for S are 12 are 98828.7470020943 out of 228771 samples."
## [4] "The worst effective sample sizes for S are 18 are 100779.691672592 out of 228771 samples."
## [5] "The worst effective sample sizes for S are 15 are 101215.109431963 out of 228771 samples."
## [6] "The worst effective sample sizes for S are 11 are 105469.752264664 out of 228771 samples."</code></pre>
<pre><code>## [1] "The worst effective sample sizes for Z are 18 are 22058.4323487105 out of 228771 samples."
## [2] "The worst effective sample sizes for Z are 16 are 22838.3921120735 out of 228771 samples."
## [3] "The worst effective sample sizes for Z are 19 are 23502.4607922624 out of 228771 samples."
## [4] "The worst effective sample sizes for Z are 13 are 31344.9787151132 out of 228771 samples."
## [5] "The worst effective sample sizes for Z are 17 are 33651.317680173 out of 228771 samples." 
## [6] "The worst effective sample sizes for Z are 14 are 36847.046426429 out of 228771 samples."</code></pre>
<pre><code>## [1] "The worst effective sample size is 75160.5048325214"</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#simulating-sampling-data">Simulating sampling data</a></li>
      <li><a href="#simulating-transmission-data">Simulating transmission data</a></li>
      <li><a href="#implementing-the-bias-adjusted-algorithm">Implementing the bias-adjusted algorithm</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Xiaoyue Xi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
