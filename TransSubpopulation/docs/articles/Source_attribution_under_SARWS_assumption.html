<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Source attribution while sampling are structured under the SARWS assumption • TransSubpopulation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Source attribution while sampling are structured under the SARWS assumption">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TransSubpopulation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Source_attribution_under_GLM.html">Source attribution while sampling are structured under the GLM assumption</a>
    </li>
    <li>
      <a href="../articles/Source_attribution_under_SARWS_assumption.html">Source attribution while sampling are structured under the SARWS assumption</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Source attribution while sampling are structured under the SARWS assumption</h1>
            
      
      
      <div class="hidden name"><code>Source_attribution_under_SARWS_assumption.Rmd</code></div>

    </div>

    
    
<div id="simulating-sampling-data" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-sampling-data" class="anchor"></a>Simulating sampling data</h2>
<p>We start by simulating data required for this task. ‘dg’ is a data table containing the number of individuals who are eligible (<strong>TRIAL</strong>) and sampled (<strong>SUC</strong>) for each subpopulation (<strong>CATEGORY</strong>). Assume there are two subpopulations where the numbers of infected individuals are 2000 and 2500 and sequencing rates are 0.6 and 0.45.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(data.table)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(TransSubpopulation)</a></code></pre></div>
<pre><code>## Warning: replacing previous import 'coda::traceplot' by 'rstan::traceplot'
## when loading 'TransSubpopulation'</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">dg&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/data.table">data.table</a></span>(<span class="dt">CATEGORY=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">TRIAL=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2000</span>,<span class="dv">2500</span>),<span class="dt">P_SEQ_EMP=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.6</span>,<span class="fl">0.45</span>))</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">dg[,SUC<span class="op">:</span><span class="er">=</span>TRIAL<span class="op">*</span>P_SEQ_EMP]</a></code></pre></div>
</div>
<div id="simulating-transmission-data" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-transmission-data" class="anchor"></a>Simulating transmission data</h2>
<p>‘dc’ a data table containing subpopulations transmitting (<strong>TR_CATEGORY</strong>) and receiving (<strong>REC_CATEGORY</strong>) the disease. Empirical sequencing rates for each subpopulation are used to evaluate the probability of a transmission between two subpopulations being observed (<strong>S</strong>).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">dc&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/data.table">data.table</a></span>(<span class="dt">TR_CATEGORY=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">REC_CATEGORY=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">tmp&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/subset.data.table">subset</a></span>(dg,<span class="dt">select=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">'CATEGORY'</span>,<span class="st">'P_SEQ_EMP'</span>))</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/setattr">setnames</a></span>(tmp,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(tmp),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">'TR_'</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(tmp)))</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">dc&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/merge">merge</a></span>(dc,tmp,<span class="dt">by=</span><span class="st">'TR_CATEGORY'</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/setattr">setnames</a></span>(tmp,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(tmp),<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">gsub</a></span>(<span class="st">'TR_'</span>,<span class="st">'REC_'</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(tmp)))</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">dc&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/merge">merge</a></span>(dc,tmp,<span class="dt">by=</span><span class="st">'REC_CATEGORY'</span>)</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">dc[,S<span class="op">:</span><span class="er">=</span>TR_P_SEQ_EMP<span class="op">*</span>REC_P_SEQ_EMP]</a></code></pre></div>
<p>Assume the probability of transmissions between subpopulations to be <span class="math inline">\(\pi=(0.36,0.04,0.06,0.54)\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">TRUE_PI&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.36</span>,<span class="fl">0.04</span>,<span class="fl">0.06</span>,<span class="fl">0.54</span>)</a></code></pre></div>
<p>Assume the observed transmission count is 300, and the observed transmissions between subpopulations can be simulated as follows:</p>
<ol style="list-style-type: decimal">
<li>generate the true transmission count <span class="math inline">\(Z \sim \mbox{Poisson} (300/S)\)</span>
</li>
<li>generate the true transmissions between groups <span class="math inline">\(z \sim \mbox{Multinomial} (Z,\pi)\)</span>
</li>
<li>generate the observed transmissions between groups <span class="math inline">\(n_{ab} \sim \mbox{Binomial} (z_{ab},\vartheta_{ab}), \forall a,b\)</span>
</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">N&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Poisson">rpois</a></span>(<span class="dv">1</span>,<span class="dv">300</span><span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(dc<span class="op">$</span>S))</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">z&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Multinom">rmultinom</a></span>(<span class="dv">1</span>,<span class="dt">size=</span>N,<span class="dt">prob=</span>TRUE_PI)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">n&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="ot">NA_integer_</span>,<span class="dt">ncol=</span><span class="dv">1</span>,<span class="dt">nrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(TRUE_PI))</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(TRUE_PI)){</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  n[i]&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Binomial">rbinom</a></span>(<span class="dv">1</span>,<span class="dt">size=</span>z[i],dc<span class="op">$</span>S[i])</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">}</a></code></pre></div>
<p>Observed transmissions between groups are recorded from the simulation and id numbers are set for stratified transmissions.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">dc<span class="op">$</span>OBS&lt;-n</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">dc<span class="op">$</span>COUNT_ID&lt;-<span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(dc)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co"># remove irrelevant terms</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">dg<span class="op">$</span>P_SEQ_EMP&lt;-<span class="ot">NULL</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">dc<span class="op">$</span>TR_P_SEQ_EMP&lt;-<span class="ot">NULL</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">dc<span class="op">$</span>REC_P_SEQ_EMP&lt;-<span class="ot">NULL</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">dc<span class="op">$</span>S&lt;-<span class="ot">NULL</span></a></code></pre></div>
<p>‘df.sampling’ is a list of data table composed of ‘dg’.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">df.sampling&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>()</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">df.sampling[[<span class="dv">1</span>]]&lt;-dg</a></code></pre></div>
<p>Here we present the form of the inputs of prior generator under SARWS, i.e. <strong>df.sampling</strong> and <strong>dc</strong>.</p>
<table class="table">
<caption>df.sampling[[1]]</caption>
<thead><tr class="header">
<th align="right">CATEGORY</th>
<th align="right">TRIAL</th>
<th align="right">SUC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2000</td>
<td align="right">1200</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2500</td>
<td align="right">1125</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>dc</caption>
<thead><tr class="header">
<th align="right">REC_CATEGORY</th>
<th align="right">TR_CATEGORY</th>
<th align="right">OBS</th>
<th align="right">COUNT_ID</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">151</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">12</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">18</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">105</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
</div>
<div id="implementing-the-bias-adjusted-algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#implementing-the-bias-adjusted-algorithm" class="anchor"></a>Implementing the bias-adjusted algorithm</h2>
<p>We now draw samples from the prior distribution under SARWS assumption using the function ‘samples.from.SARWS.prior’. Running the following lines gives you information required for MCMC algorithm, i.e. S.DTL.prior and TR.OBS and save data under your working directory.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/samples.from.SARWS.prior.html">samples.from.SARWS.prior</a></span>(<span class="dt">df.sampling=</span>df.sampling,<span class="dt">dc=</span>dc,<span class="dt">iteration=</span><span class="fl">1e6</span>,<span class="dt">seed=</span><span class="dv">123</span>)</a></code></pre></div>
<p>After loading the samples from the prior distribution, we can use the following algorithm to estimate the proportion of transmissions between subpopulations when correcting for sampling differences.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/mcmc.core.inference.html">mcmc.core.inference</a></span>(<span class="dt">s.dtl.prior=</span>S.DTL.prior,<span class="dt">tr.obs=</span>TR.OBS,<span class="dt">seed=</span><span class="dv">123</span>)</a></code></pre></div>
<p>The estimated proportions of transmissions between subpopulations are summerised as follows.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># runtime of the algorithm</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(time)</a></code></pre></div>
<pre><code>## Time difference of 16.98823 mins</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">PI.summary&lt;-<span class="kw"><a href="https://www.rdocumentation.org/packages/data.table/topics/data.table">data.table</a></span>(<span class="dt">PI_MEDIAN=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(mc<span class="op">$</span>pars<span class="op">$</span>PI,<span class="dv">2</span>,median),</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">                       <span class="dt">PI_LOWER=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(mc<span class="op">$</span>pars<span class="op">$</span>PI,<span class="dv">2</span>,<span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(x,<span class="fl">0.025</span>)}),</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">                       <span class="dt">PI_UPPER=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(mc<span class="op">$</span>pars<span class="op">$</span>PI,<span class="dv">2</span>,<span class="cf">function</span>(x){<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/quantile">quantile</a></span>(x,<span class="fl">0.975</span>)}),</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">                       <span class="dt">PI_TRUE=</span>TRUE_PI,</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">                       <span class="dt">ID=</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</a></code></pre></div>
<table class="table">
<caption>summary of PI</caption>
<thead><tr class="header">
<th align="right">PI_MEDIAN</th>
<th align="right">PI_LOWER</th>
<th align="right">PI_UPPER</th>
<th align="right">PI_TRUE</th>
<th align="right">ID</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.3978671</td>
<td align="right">0.3422201</td>
<td align="right">0.4572354</td>
<td align="right">0.36</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">0.0410075</td>
<td align="right">0.0219442</td>
<td align="right">0.0679737</td>
<td align="right">0.04</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">0.0623690</td>
<td align="right">0.0379292</td>
<td align="right">0.0942129</td>
<td align="right">0.06</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">0.4965101</td>
<td align="right">0.4340396</td>
<td align="right">0.5568949</td>
<td align="right">0.54</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<p>If you want to visualise MCMC convergence diagnostics, you may use the function ‘mcmc.core.inference.diagnostics’ and all the results are saved in your computer.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="../reference/mcmc.core.inference.diagnostics.html">mcmc.core.inference.diagnostics</a></span>(mc,<span class="fl">2e3</span>)</a></code></pre></div>
<pre><code>## [1] "The worst effective sample sizes for PI 4 are 13929.1557605435 out of 331335 samples."
## [2] "The worst effective sample sizes for PI 1 are 17699.8034155086 out of 331335 samples."
## [3] "The worst effective sample sizes for PI 3 are 21926.9968008574 out of 331335 samples."
## [4] "The worst effective sample sizes for PI 2 are 36125.7342082732 out of 331335 samples."</code></pre>
<pre><code>## [1] "The worst effective sample sizes for S 1 are 63332.1465498188 out of 331335 samples."
## [2] "The worst effective sample sizes for S 4 are 78274.3954773614 out of 331335 samples."
## [3] "The worst effective sample sizes for S 2 are 157899.843802123 out of 331335 samples."
## [4] "The worst effective sample sizes for S 3 are 157899.843802123 out of 331335 samples."</code></pre>
<pre><code>## [1] "The worst effective sample sizes for Z are 4 are 10510.8042489529 out of 331335 samples."
## [2] "The worst effective sample sizes for Z are 3 are 19069.6443187134 out of 331335 samples."
## [3] "The worst effective sample sizes for Z are 1 are 23545.3311156127 out of 331335 samples."
## [4] "The worst effective sample sizes for Z are 2 are 32620.8928256698 out of 331335 samples."</code></pre>
<pre><code>## [1] "The worst effective sample size is 39169.8522818416"</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#simulating-sampling-data">Simulating sampling data</a></li>
      <li><a href="#simulating-transmission-data">Simulating transmission data</a></li>
      <li><a href="#implementing-the-bias-adjusted-algorithm">Implementing the bias-adjusted algorithm</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Xiaoyue Xi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
