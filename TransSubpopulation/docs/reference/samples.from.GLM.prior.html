<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Drawing samples from the prior distribution given by generalised linear model. — samples.from.GLM.prior • TransSubpopulation</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Drawing samples from the prior distribution given by generalised linear model. — samples.from.GLM.prior" />

<meta property="og:description" content="This function provides the inputs for mcmc sampler. Samples are drawn from the prior distribution of the sampling rate and the corresponding densities are evaluated. The prior distribution is informative and given by a posterior distribution inferred from Bayesian hierarchical model using empirical sampling rate and group covariates." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TransSubpopulation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Source_attribution_under_GLM.html">Source attribution while sampling are structured under the GLM assumption</a>
    </li>
    <li>
      <a href="../articles/Source_attribution_under_SARWS_assumption.html">Source attribution while sampling are structured under the SARWS assumption</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Drawing samples from the prior distribution given by generalised linear model.</h1>
    
    <div class="hidden name"><code>samples.from.GLM.prior.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function provides the inputs for mcmc sampler. Samples are drawn from the prior distribution of the sampling rate and the corresponding densities are evaluated. The prior distribution is informative and given by a posterior distribution inferred from Bayesian hierarchical model using empirical sampling rate and group covariates.</p>
    
    </div>

    <pre class="usage"><span class='fu'>samples.from.GLM.prior</span>(<span class='no'>df.sampling</span>,<span class='no'>dc</span>,<span class='no'>iteration</span>,<span class='no'>sample.method</span>,<span class='no'>glm.model</span>,<span class='no'>seed</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>df.sampling</th>
      <td><p>a list of data tables each of which includes data used for infering the distribution of sampling rates through a hierarchical model, i.e. the number of eligible individuals and individual sampled in each subpopulation, the covariates of individuals in a subpopulation.</p></td>
    </tr>
    <tr>
      <th>dc</th>
      <td><p>a data table includes transmission counts between subpopulations and covariates of transmitters' and recipients' subpopulations.</p></td>
    </tr>
    <tr>
      <th>iteration</th>
      <td><p>the number of iterations for mcmc sampler, which decides the number of prior samples needed.</p></td>
    </tr>
    <tr>
      <th>sample.method</th>
      <td><p>the methods for evaluating density of each samples. method='empirical' indicates density of samples come from an empirical distribution, method='betaapprox' indicates a beta distribution is used to approximate the distribution of samples.</p></td>
    </tr>
    <tr>
      <th>glm.model</th>
      <td><p>the type of glm model for infering the sampling rates. glm.model='binomial' indicates using binomial model, glm.model='beta-binomial' indicates using beta-binomial model. Choices of glm.model needed to be determined by posterior predictive checks.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>the random seed.</p></td>
    </tr>
    </table>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>data.table</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>Boom</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: MASS</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘Boom’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:coda’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    thin</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    rWishart</span></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>123</span>)
<span class='co'># assume 120 infected individuals in 1 and 80 infected individuals in 2</span>
<span class='co'># 70% are female in 1 and 60% are females in 2</span>
<span class='co'># in 1 F: 25% 15-24 60% 25-34 15% 35+</span>
<span class='co'># in 1 M: 20% 15-24 50% 25-34 30% 35+</span>
<span class='co'># in 2 F: 25% 15-24 50% 25-34 25% 35+</span>
<span class='co'># in 2 M: 20% 15-24 40% 25-34 40% 35+</span>
<span class='no'>dg</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/data.table'>data.table</a></span>(<span class='kw'>COMM_NUM_B</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>1</span>,<span class='fl'>120</span>),<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>2</span>,<span class='fl'>80</span>)),<span class='kw'>INF</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='fl'>1</span>,<span class='fl'>200</span>))
<span class='no'>num.f.1</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='fl'>120</span>*<span class='fl'>0.7</span>)
<span class='no'>num.m.1</span><span class='kw'>&lt;-</span><span class='fl'>120</span>-<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='fl'>120</span>*<span class='fl'>0.7</span>)
<span class='no'>num.f.2</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='fl'>80</span>*<span class='fl'>0.6</span>)
<span class='no'>num.m.2</span><span class='kw'>&lt;-</span><span class='fl'>80</span>-<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='fl'>80</span>*<span class='fl'>0.6</span>)

<span class='no'>dg</span>$<span class='no'>SEX</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'F'</span>,<span class='no'>num.f.1</span>),
          <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'M'</span>,<span class='no'>num.m.1</span>),
          <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'F'</span>,<span class='no'>num.f.2</span>),
          <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'M'</span>,<span class='no'>num.m.2</span>))
<span class='no'>dg</span>$<span class='no'>AGE_AT_MID_C</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'15-24'</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.f.1</span>*<span class='fl'>0.25</span>)),
                   <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'25-34'</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.f.1</span>*<span class='fl'>0.6</span>)),
                   <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'35+'</span>,<span class='no'>num.f.1</span>-<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.f.1</span>*<span class='fl'>0.25</span>)-<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.f.1</span>*<span class='fl'>0.6</span>)),
                   <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'15-24'</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.m.1</span>*<span class='fl'>0.2</span>)),
                   <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'25-34'</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.m.1</span>*<span class='fl'>0.5</span>)),
                   <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'35+'</span>,<span class='no'>num.m.1</span>-<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.m.1</span>*<span class='fl'>0.2</span>)-<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.m.1</span>*<span class='fl'>0.5</span>)),
                   <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'15-24'</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.f.2</span>*<span class='fl'>0.25</span>)),
                   <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'25-34'</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.f.2</span>*<span class='fl'>0.5</span>)),
                   <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'35+'</span>,<span class='no'>num.f.2</span>-<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.f.2</span>*<span class='fl'>0.25</span>)-<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.f.2</span>*<span class='fl'>0.5</span>)),
                   <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'15-24'</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.m.2</span>*<span class='fl'>0.2</span>)),
                   <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'25-34'</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.m.2</span>*<span class='fl'>0.4</span>)),
                   <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>'35+'</span>,<span class='no'>num.m.2</span>-<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.m.2</span>*<span class='fl'>0.2</span>)-<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Round'>round</a></span>(<span class='no'>num.m.2</span>*<span class='fl'>0.4</span>))
                   )

<span class='co'># regression coefficients</span>
<span class='no'>dg</span>              <span class='kw'>&lt;-</span> <span class='no'>dg</span>[, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>TRIAL</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>INF</span>)),<span class='kw'>by</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>'AGE_AT_MID_C'</span>,<span class='st'>'SEX'</span>,<span class='st'>'COMM_NUM_B'</span>)]
<span class='no'>comm</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.5</span>,-<span class='fl'>0.5</span>)
<span class='no'>a</span><span class='kw'>&lt;-</span><span class='fl'>0.4</span>
<span class='no'>male</span><span class='kw'>&lt;-</span><span class='fl'>0.4</span>
<span class='no'>young</span><span class='kw'>&lt;-</span><span class='fl'>0.3</span>
<span class='no'>midage</span><span class='kw'>&lt;-</span><span class='fl'>0.2</span>

<span class='co'>#	binarize age, sex</span>
<span class='no'>dg</span>[, <span class='no'>AGE1</span><span class='kw'>:=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/integer'>as.integer</a></span>(<span class='no'>AGE_AT_MID_C</span><span class='kw'>==</span><span class='st'>'15-24'</span>)]</div><div class='output co'>#&gt;     AGE_AT_MID_C SEX COMM_NUM_B TRIAL AGE1
#&gt;  1:        15-24   F          1    21    1
#&gt;  2:        25-34   F          1    50    0
#&gt;  3:          35+   F          1    13    0
#&gt;  4:        15-24   M          1     7    1
#&gt;  5:        25-34   M          1    18    0
#&gt;  6:          35+   M          1    11    0
#&gt;  7:        15-24   F          2    12    1
#&gt;  8:        25-34   F          2    24    0
#&gt;  9:          35+   F          2    12    0
#&gt; 10:        15-24   M          2     6    1
#&gt; 11:        25-34   M          2    13    0
#&gt; 12:          35+   M          2    13    0</div><div class='input'><span class='no'>dg</span>[, <span class='no'>AGE2</span><span class='kw'>:=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/integer'>as.integer</a></span>(<span class='no'>AGE_AT_MID_C</span><span class='kw'>==</span><span class='st'>'25-34'</span>)]</div><div class='output co'>#&gt;     AGE_AT_MID_C SEX COMM_NUM_B TRIAL AGE1 AGE2
#&gt;  1:        15-24   F          1    21    1    0
#&gt;  2:        25-34   F          1    50    0    1
#&gt;  3:          35+   F          1    13    0    0
#&gt;  4:        15-24   M          1     7    1    0
#&gt;  5:        25-34   M          1    18    0    1
#&gt;  6:          35+   M          1    11    0    0
#&gt;  7:        15-24   F          2    12    1    0
#&gt;  8:        25-34   F          2    24    0    1
#&gt;  9:          35+   F          2    12    0    0
#&gt; 10:        15-24   M          2     6    1    0
#&gt; 11:        25-34   M          2    13    0    1
#&gt; 12:          35+   M          2    13    0    0</div><div class='input'><span class='no'>dg</span>[, <span class='no'>MALE</span><span class='kw'>:=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/integer'>as.integer</a></span>(<span class='no'>SEX</span><span class='kw'>==</span><span class='st'>'M'</span>)]</div><div class='output co'>#&gt;     AGE_AT_MID_C SEX COMM_NUM_B TRIAL AGE1 AGE2 MALE
#&gt;  1:        15-24   F          1    21    1    0    0
#&gt;  2:        25-34   F          1    50    0    1    0
#&gt;  3:          35+   F          1    13    0    0    0
#&gt;  4:        15-24   M          1     7    1    0    1
#&gt;  5:        25-34   M          1    18    0    1    1
#&gt;  6:          35+   M          1    11    0    0    1
#&gt;  7:        15-24   F          2    12    1    0    0
#&gt;  8:        25-34   F          2    24    0    1    0
#&gt;  9:          35+   F          2    12    0    0    0
#&gt; 10:        15-24   M          2     6    1    0    1
#&gt; 11:        25-34   M          2    13    0    1    1
#&gt; 12:          35+   M          2    13    0    0    1</div><div class='input'>
<span class='no'>dg</span>[,<span class='no'>LOGIT_P_SEQ</span><span class='kw'>:=</span><span class='no'>a</span> + <span class='no'>comm</span>[<span class='no'>COMM_NUM_B</span>] + <span class='no'>male</span>*<span class='no'>MALE</span> + <span class='no'>young</span>*<span class='no'>AGE1</span> + <span class='no'>midage</span>*<span class='no'>AGE2</span>]</div><div class='output co'>#&gt;     AGE_AT_MID_C SEX COMM_NUM_B TRIAL AGE1 AGE2 MALE LOGIT_P_SEQ
#&gt;  1:        15-24   F          1    21    1    0    0         1.2
#&gt;  2:        25-34   F          1    50    0    1    0         1.1
#&gt;  3:          35+   F          1    13    0    0    0         0.9
#&gt;  4:        15-24   M          1     7    1    0    1         1.6
#&gt;  5:        25-34   M          1    18    0    1    1         1.5
#&gt;  6:          35+   M          1    11    0    0    1         1.3
#&gt;  7:        15-24   F          2    12    1    0    0         0.2
#&gt;  8:        25-34   F          2    24    0    1    0         0.1
#&gt;  9:          35+   F          2    12    0    0    0        -0.1
#&gt; 10:        15-24   M          2     6    1    0    1         0.6
#&gt; 11:        25-34   M          2    13    0    1    1         0.5
#&gt; 12:          35+   M          2    13    0    0    1         0.3</div><div class='input'><span class='no'>dg</span>[,<span class='no'>P_SEQ</span><span class='kw'>:=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>exp</a></span>(<span class='no'>LOGIT_P_SEQ</span>)/(<span class='fl'>1</span>+<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Log'>exp</a></span>(<span class='no'>LOGIT_P_SEQ</span>))]</div><div class='output co'>#&gt;     AGE_AT_MID_C SEX COMM_NUM_B TRIAL AGE1 AGE2 MALE LOGIT_P_SEQ     P_SEQ
#&gt;  1:        15-24   F          1    21    1    0    0         1.2 0.7685248
#&gt;  2:        25-34   F          1    50    0    1    0         1.1 0.7502601
#&gt;  3:          35+   F          1    13    0    0    0         0.9 0.7109495
#&gt;  4:        15-24   M          1     7    1    0    1         1.6 0.8320184
#&gt;  5:        25-34   M          1    18    0    1    1         1.5 0.8175745
#&gt;  6:          35+   M          1    11    0    0    1         1.3 0.7858350
#&gt;  7:        15-24   F          2    12    1    0    0         0.2 0.5498340
#&gt;  8:        25-34   F          2    24    0    1    0         0.1 0.5249792
#&gt;  9:          35+   F          2    12    0    0    0        -0.1 0.4750208
#&gt; 10:        15-24   M          2     6    1    0    1         0.6 0.6456563
#&gt; 11:        25-34   M          2    13    0    1    1         0.5 0.6224593
#&gt; 12:          35+   M          2    13    0    0    1         0.3 0.5744425</div><div class='input'><span class='no'>dg</span>[,<span class='no'>SUC</span><span class='kw'>:=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Binomial'>rbinom</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span>(<span class='no'>dg</span>),<span class='no'>TRIAL</span>,<span class='no'>P_SEQ</span>)]</div><div class='output co'>#&gt;     AGE_AT_MID_C SEX COMM_NUM_B TRIAL AGE1 AGE2 MALE LOGIT_P_SEQ     P_SEQ SUC
#&gt;  1:        15-24   F          1    21    1    0    0         1.2 0.7685248  17
#&gt;  2:        25-34   F          1    50    0    1    0         1.1 0.7502601  35
#&gt;  3:          35+   F          1    13    0    0    0         0.9 0.7109495  10
#&gt;  4:        15-24   M          1     7    1    0    1         1.6 0.8320184   5
#&gt;  5:        25-34   M          1    18    0    1    1         1.5 0.8175745  12
#&gt;  6:          35+   M          1    11    0    0    1         1.3 0.7858350  11
#&gt;  7:        15-24   F          2    12    1    0    0         0.2 0.5498340   6
#&gt;  8:        25-34   F          2    24    0    1    0         0.1 0.5249792  10
#&gt;  9:          35+   F          2    12    0    0    0        -0.1 0.4750208   6
#&gt; 10:        15-24   M          2     6    1    0    1         0.6 0.6456563   4
#&gt; 11:        25-34   M          2    13    0    1    1         0.5 0.6224593   5
#&gt; 12:          35+   M          2    13    0    0    1         0.3 0.5744425   8</div><div class='input'>
<span class='no'>dg</span>[,<span class='no'>CATEGORY</span><span class='kw'>:=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='no'>COMM_NUM_B</span>,<span class='st'>':'</span>,<span class='no'>SEX</span>,<span class='st'>':'</span>,<span class='no'>AGE_AT_MID_C</span>)]</div><div class='output co'>#&gt;     AGE_AT_MID_C SEX COMM_NUM_B TRIAL AGE1 AGE2 MALE LOGIT_P_SEQ     P_SEQ SUC
#&gt;  1:        15-24   F          1    21    1    0    0         1.2 0.7685248  17
#&gt;  2:        25-34   F          1    50    0    1    0         1.1 0.7502601  35
#&gt;  3:          35+   F          1    13    0    0    0         0.9 0.7109495  10
#&gt;  4:        15-24   M          1     7    1    0    1         1.6 0.8320184   5
#&gt;  5:        25-34   M          1    18    0    1    1         1.5 0.8175745  12
#&gt;  6:          35+   M          1    11    0    0    1         1.3 0.7858350  11
#&gt;  7:        15-24   F          2    12    1    0    0         0.2 0.5498340   6
#&gt;  8:        25-34   F          2    24    0    1    0         0.1 0.5249792  10
#&gt;  9:          35+   F          2    12    0    0    0        -0.1 0.4750208   6
#&gt; 10:        15-24   M          2     6    1    0    1         0.6 0.6456563   4
#&gt; 11:        25-34   M          2    13    0    1    1         0.5 0.6224593   5
#&gt; 12:          35+   M          2    13    0    0    1         0.3 0.5744425   8
#&gt;      CATEGORY
#&gt;  1: 1:F:15-24
#&gt;  2: 1:F:25-34
#&gt;  3:   1:F:35+
#&gt;  4: 1:M:15-24
#&gt;  5: 1:M:25-34
#&gt;  6:   1:M:35+
#&gt;  7: 2:F:15-24
#&gt;  8: 2:F:25-34
#&gt;  9:   2:F:35+
#&gt; 10: 2:M:15-24
#&gt; 11: 2:M:25-34
#&gt; 12:   2:M:35+</div><div class='input'><span class='no'>dg</span>[,<span class='no'>COMM_NUM_B</span><span class='kw'>:=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/integer'>as.integer</a></span>(<span class='no'>COMM_NUM_B</span>)]</div><div class='output co'>#&gt;     AGE_AT_MID_C SEX COMM_NUM_B TRIAL AGE1 AGE2 MALE LOGIT_P_SEQ     P_SEQ SUC
#&gt;  1:        15-24   F          1    21    1    0    0         1.2 0.7685248  17
#&gt;  2:        25-34   F          1    50    0    1    0         1.1 0.7502601  35
#&gt;  3:          35+   F          1    13    0    0    0         0.9 0.7109495  10
#&gt;  4:        15-24   M          1     7    1    0    1         1.6 0.8320184   5
#&gt;  5:        25-34   M          1    18    0    1    1         1.5 0.8175745  12
#&gt;  6:          35+   M          1    11    0    0    1         1.3 0.7858350  11
#&gt;  7:        15-24   F          2    12    1    0    0         0.2 0.5498340   6
#&gt;  8:        25-34   F          2    24    0    1    0         0.1 0.5249792  10
#&gt;  9:          35+   F          2    12    0    0    0        -0.1 0.4750208   6
#&gt; 10:        15-24   M          2     6    1    0    1         0.6 0.6456563   4
#&gt; 11:        25-34   M          2    13    0    1    1         0.5 0.6224593   5
#&gt; 12:          35+   M          2    13    0    0    1         0.3 0.5744425   8
#&gt;      CATEGORY
#&gt;  1: 1:F:15-24
#&gt;  2: 1:F:25-34
#&gt;  3:   1:F:35+
#&gt;  4: 1:M:15-24
#&gt;  5: 1:M:25-34
#&gt;  6:   1:M:35+
#&gt;  7: 2:F:15-24
#&gt;  8: 2:F:25-34
#&gt;  9:   2:F:35+
#&gt; 10: 2:M:15-24
#&gt; 11: 2:M:25-34
#&gt; 12:   2:M:35+</div><div class='input'>
<span class='co'>#dc</span>
<span class='no'>dc</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/as.data.table'>as.data.table</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/expand.grid'>expand.grid</a></span>(<span class='kw'>TR_CATEGORY</span><span class='kw'>=</span><span class='no'>dg</span>$<span class='no'>CATEGORY</span>,<span class='kw'>REC_CATEGORY</span><span class='kw'>=</span><span class='no'>dg</span>$<span class='no'>CATEGORY</span>))
<span class='no'>dc</span>[,<span class='no'>COUNT_ID</span><span class='kw'>:=</span><span class='fl'>1</span>:<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span>(<span class='no'>dc</span>)]</div><div class='output co'>#&gt;      TR_CATEGORY REC_CATEGORY COUNT_ID
#&gt;   1:   1:F:15-24    1:F:15-24        1
#&gt;   2:   1:F:25-34    1:F:15-24        2
#&gt;   3:     1:F:35+    1:F:15-24        3
#&gt;   4:   1:M:15-24    1:F:15-24        4
#&gt;   5:   1:M:25-34    1:F:15-24        5
#&gt;  ---                                  
#&gt; 140:   2:F:25-34      2:M:35+      140
#&gt; 141:     2:F:35+      2:M:35+      141
#&gt; 142:   2:M:15-24      2:M:35+      142
#&gt; 143:   2:M:25-34      2:M:35+      143
#&gt; 144:     2:M:35+      2:M:35+      144</div><div class='input'><span class='no'>dc</span>[, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"TR_COMM_NUM_B"</span>,<span class='st'>"TR_SEX"</span>, <span class='st'>"TR_AGE_AT_MID_C"</span>) <span class='kw'>:=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/tstrsplit'>tstrsplit</a></span>(<span class='no'>TR_CATEGORY</span>, <span class='st'>":"</span>, <span class='kw'>fixed</span><span class='kw'>=</span><span class='fl'>TRUE</span>)]</div><div class='output co'>#&gt;      TR_CATEGORY REC_CATEGORY COUNT_ID TR_COMM_NUM_B TR_SEX TR_AGE_AT_MID_C
#&gt;   1:   1:F:15-24    1:F:15-24        1             1      F           15-24
#&gt;   2:   1:F:25-34    1:F:15-24        2             1      F           25-34
#&gt;   3:     1:F:35+    1:F:15-24        3             1      F             35+
#&gt;   4:   1:M:15-24    1:F:15-24        4             1      M           15-24
#&gt;   5:   1:M:25-34    1:F:15-24        5             1      M           25-34
#&gt;  ---                                                                       
#&gt; 140:   2:F:25-34      2:M:35+      140             2      F           25-34
#&gt; 141:     2:F:35+      2:M:35+      141             2      F             35+
#&gt; 142:   2:M:15-24      2:M:35+      142             2      M           15-24
#&gt; 143:   2:M:25-34      2:M:35+      143             2      M           25-34
#&gt; 144:     2:M:35+      2:M:35+      144             2      M             35+</div><div class='input'><span class='no'>dc</span>[, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"REC_COMM_NUM_B"</span>,<span class='st'>"REC_SEX"</span>, <span class='st'>"REC_AGE_AT_MID_C"</span>) <span class='kw'>:=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/tstrsplit'>tstrsplit</a></span>(<span class='no'>REC_CATEGORY</span>, <span class='st'>":"</span>, <span class='kw'>fixed</span><span class='kw'>=</span><span class='fl'>TRUE</span>)]</div><div class='output co'>#&gt;      TR_CATEGORY REC_CATEGORY COUNT_ID TR_COMM_NUM_B TR_SEX TR_AGE_AT_MID_C
#&gt;   1:   1:F:15-24    1:F:15-24        1             1      F           15-24
#&gt;   2:   1:F:25-34    1:F:15-24        2             1      F           25-34
#&gt;   3:     1:F:35+    1:F:15-24        3             1      F             35+
#&gt;   4:   1:M:15-24    1:F:15-24        4             1      M           15-24
#&gt;   5:   1:M:25-34    1:F:15-24        5             1      M           25-34
#&gt;  ---                                                                       
#&gt; 140:   2:F:25-34      2:M:35+      140             2      F           25-34
#&gt; 141:     2:F:35+      2:M:35+      141             2      F             35+
#&gt; 142:   2:M:15-24      2:M:35+      142             2      M           15-24
#&gt; 143:   2:M:25-34      2:M:35+      143             2      M           25-34
#&gt; 144:     2:M:35+      2:M:35+      144             2      M             35+
#&gt;      REC_COMM_NUM_B REC_SEX REC_AGE_AT_MID_C
#&gt;   1:              1       F            15-24
#&gt;   2:              1       F            15-24
#&gt;   3:              1       F            15-24
#&gt;   4:              1       F            15-24
#&gt;   5:              1       F            15-24
#&gt;  ---                                        
#&gt; 140:              2       M              35+
#&gt; 141:              2       M              35+
#&gt; 142:              2       M              35+
#&gt; 143:              2       M              35+
#&gt; 144:              2       M              35+</div><div class='input'>
<span class='no'>dc</span><span class='kw'>&lt;-</span><span class='no'>dc</span>[<span class='no'>TR_SEX</span><span class='kw'>!=</span><span class='no'>REC_SEX</span>,]

<span class='co'># transmission proportions</span>
<span class='no'>lbd</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>NA_real_</span>,<span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span>(<span class='no'>dc</span>))
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span>(<span class='no'>dc</span>)){
  <span class='kw'>if</span> (<span class='no'>dc</span>$<span class='no'>TR_COMM_NUM_B</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='no'>dc</span>$<span class='no'>REC_COMM_NUM_B</span>[<span class='no'>i</span>]){
    <span class='kw'>if</span> ( (<span class='no'>dc</span>$<span class='no'>TR_AGE_AT_MID_C</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='st'>'15-24'</span> <span class='kw'>&amp;</span> <span class='no'>dc</span>$<span class='no'>REC_AGE_AT_MID_C</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='st'>'25-34'</span>) <span class='kw'>|</span>
         (<span class='no'>dc</span>$<span class='no'>TR_AGE_AT_MID_C</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='st'>'15-24'</span> <span class='kw'>&amp;</span> <span class='no'>dc</span>$<span class='no'>REC_AGE_AT_MID_C</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='st'>'35+'</span>) <span class='kw'>|</span>
         (<span class='no'>dc</span>$<span class='no'>TR_AGE_AT_MID_C</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='st'>'25-34'</span> <span class='kw'>&amp;</span> <span class='no'>dc</span>$<span class='no'>REC_AGE_AT_MID_C</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='st'>'35+'</span>)){
      <span class='kw'>if</span> (<span class='no'>dc</span>$<span class='no'>TR_SEX</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='st'>'M'</span>){
        <span class='no'>lbd</span>[<span class='no'>i</span>]<span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0.2</span>)
      }<span class='kw'>else</span>{
        <span class='no'>lbd</span>[<span class='no'>i</span>]<span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>0.2</span>)
      }
    }<span class='kw'>else</span> <span class='kw'>if</span> ( (<span class='no'>dc</span>$<span class='no'>REC_AGE_AT_MID_C</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='st'>'15-24'</span> <span class='kw'>&amp;</span> <span class='no'>dc</span>$<span class='no'>TR_AGE_AT_MID_C</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='st'>'25-34'</span>) <span class='kw'>|</span>
               (<span class='no'>dc</span>$<span class='no'>REC_AGE_AT_MID_C</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='st'>'15-24'</span> <span class='kw'>&amp;</span> <span class='no'>dc</span>$<span class='no'>TR_AGE_AT_MID_C</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='st'>'35+'</span>) <span class='kw'>|</span>
               (<span class='no'>dc</span>$<span class='no'>REC_AGE_AT_MID_C</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='st'>'25-34'</span> <span class='kw'>&amp;</span> <span class='no'>dc</span>$<span class='no'>TR_AGE_AT_MID_C</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='st'>'35+'</span>)){
      <span class='kw'>if</span> (<span class='no'>dc</span>$<span class='no'>TR_SEX</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='st'>'M'</span>){
        <span class='no'>lbd</span>[<span class='no'>i</span>]<span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>0.2</span>)
      }<span class='kw'>else</span>{
        <span class='no'>lbd</span>[<span class='no'>i</span>]<span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0.2</span>)
      }
    }<span class='kw'>else</span> <span class='kw'>if</span>(<span class='no'>dc</span>$<span class='no'>TR_AGE_AT_MID_C</span>[<span class='no'>i</span>]<span class='kw'>==</span><span class='no'>dc</span>$<span class='no'>REC_AGE_AT_MID_C</span>[<span class='no'>i</span>]){
      <span class='no'>lbd</span>[<span class='no'>i</span>]<span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>0.2</span>)
    }
  }<span class='kw'>else</span>{
    <span class='no'>lbd</span>[<span class='no'>i</span>]<span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0.2</span>)
  }
}
<span class='no'>TRUE_PI</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/Boom/topics/dirichlet-distribution'>rdirichlet</a></span>(<span class='fl'>1</span>,<span class='no'>lbd</span>)

<span class='no'>tmp</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/subset.data.table'>subset</a></span>(<span class='no'>dg</span>,<span class='kw'>select</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>'CATEGORY'</span>,<span class='st'>'P_SEQ'</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/setattr'>setnames</a></span>(<span class='no'>tmp</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>tmp</span>),<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>'TR_'</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>tmp</span>)))
<span class='no'>dc</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/merge'>merge</a></span>(<span class='no'>dc</span>,<span class='no'>tmp</span>,<span class='kw'>by</span><span class='kw'>=</span><span class='st'>'TR_CATEGORY'</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/setattr'>setnames</a></span>(<span class='no'>tmp</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>tmp</span>),<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/grep'>gsub</a></span>(<span class='st'>'TR_'</span>,<span class='st'>'REC_'</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>tmp</span>)))
<span class='no'>dc</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/merge'>merge</a></span>(<span class='no'>dc</span>,<span class='no'>tmp</span>,<span class='kw'>by</span><span class='kw'>=</span><span class='st'>'REC_CATEGORY'</span>)
<span class='no'>dc</span>[,<span class='no'>S</span><span class='kw'>:=</span><span class='no'>TR_P_SEQ</span>*<span class='no'>REC_P_SEQ</span>]</div><div class='output co'>#&gt;     REC_CATEGORY TR_CATEGORY COUNT_ID TR_COMM_NUM_B TR_SEX TR_AGE_AT_MID_C
#&gt;  1:    1:F:15-24   1:M:15-24        4             1      M           15-24
#&gt;  2:    1:F:15-24   1:M:25-34        5             1      M           25-34
#&gt;  3:    1:F:15-24     1:M:35+        6             1      M             35+
#&gt;  4:    1:F:15-24   2:M:15-24       10             2      M           15-24
#&gt;  5:    1:F:15-24   2:M:25-34       11             2      M           25-34
#&gt;  6:    1:F:15-24     2:M:35+       12             2      M             35+
#&gt;  7:    1:F:25-34   1:M:15-24       16             1      M           15-24
#&gt;  8:    1:F:25-34   1:M:25-34       17             1      M           25-34
#&gt;  9:    1:F:25-34     1:M:35+       18             1      M             35+
#&gt; 10:    1:F:25-34   2:M:15-24       22             2      M           15-24
#&gt; 11:    1:F:25-34   2:M:25-34       23             2      M           25-34
#&gt; 12:    1:F:25-34     2:M:35+       24             2      M             35+
#&gt; 13:      1:F:35+   1:M:15-24       28             1      M           15-24
#&gt; 14:      1:F:35+   1:M:25-34       29             1      M           25-34
#&gt; 15:      1:F:35+     1:M:35+       30             1      M             35+
#&gt; 16:      1:F:35+   2:M:15-24       34             2      M           15-24
#&gt; 17:      1:F:35+   2:M:25-34       35             2      M           25-34
#&gt; 18:      1:F:35+     2:M:35+       36             2      M             35+
#&gt; 19:    1:M:15-24   1:F:15-24       37             1      F           15-24
#&gt; 20:    1:M:15-24   1:F:25-34       38             1      F           25-34
#&gt; 21:    1:M:15-24     1:F:35+       39             1      F             35+
#&gt; 22:    1:M:15-24   2:F:15-24       43             2      F           15-24
#&gt; 23:    1:M:15-24   2:F:25-34       44             2      F           25-34
#&gt; 24:    1:M:15-24     2:F:35+       45             2      F             35+
#&gt; 25:    1:M:25-34   1:F:15-24       49             1      F           15-24
#&gt; 26:    1:M:25-34   1:F:25-34       50             1      F           25-34
#&gt; 27:    1:M:25-34     1:F:35+       51             1      F             35+
#&gt; 28:    1:M:25-34   2:F:15-24       55             2      F           15-24
#&gt; 29:    1:M:25-34   2:F:25-34       56             2      F           25-34
#&gt; 30:    1:M:25-34     2:F:35+       57             2      F             35+
#&gt; 31:      1:M:35+   1:F:15-24       61             1      F           15-24
#&gt; 32:      1:M:35+   1:F:25-34       62             1      F           25-34
#&gt; 33:      1:M:35+     1:F:35+       63             1      F             35+
#&gt; 34:      1:M:35+   2:F:15-24       67             2      F           15-24
#&gt; 35:      1:M:35+   2:F:25-34       68             2      F           25-34
#&gt; 36:      1:M:35+     2:F:35+       69             2      F             35+
#&gt; 37:    2:F:15-24   1:M:15-24       76             1      M           15-24
#&gt; 38:    2:F:15-24   1:M:25-34       77             1      M           25-34
#&gt; 39:    2:F:15-24     1:M:35+       78             1      M             35+
#&gt; 40:    2:F:15-24   2:M:15-24       82             2      M           15-24
#&gt; 41:    2:F:15-24   2:M:25-34       83             2      M           25-34
#&gt; 42:    2:F:15-24     2:M:35+       84             2      M             35+
#&gt; 43:    2:F:25-34   1:M:15-24       88             1      M           15-24
#&gt; 44:    2:F:25-34   1:M:25-34       89             1      M           25-34
#&gt; 45:    2:F:25-34     1:M:35+       90             1      M             35+
#&gt; 46:    2:F:25-34   2:M:15-24       94             2      M           15-24
#&gt; 47:    2:F:25-34   2:M:25-34       95             2      M           25-34
#&gt; 48:    2:F:25-34     2:M:35+       96             2      M             35+
#&gt; 49:      2:F:35+   1:M:15-24      100             1      M           15-24
#&gt; 50:      2:F:35+   1:M:25-34      101             1      M           25-34
#&gt; 51:      2:F:35+     1:M:35+      102             1      M             35+
#&gt; 52:      2:F:35+   2:M:15-24      106             2      M           15-24
#&gt; 53:      2:F:35+   2:M:25-34      107             2      M           25-34
#&gt; 54:      2:F:35+     2:M:35+      108             2      M             35+
#&gt; 55:    2:M:15-24   1:F:15-24      109             1      F           15-24
#&gt; 56:    2:M:15-24   1:F:25-34      110             1      F           25-34
#&gt; 57:    2:M:15-24     1:F:35+      111             1      F             35+
#&gt; 58:    2:M:15-24   2:F:15-24      115             2      F           15-24
#&gt; 59:    2:M:15-24   2:F:25-34      116             2      F           25-34
#&gt; 60:    2:M:15-24     2:F:35+      117             2      F             35+
#&gt; 61:    2:M:25-34   1:F:15-24      121             1      F           15-24
#&gt; 62:    2:M:25-34   1:F:25-34      122             1      F           25-34
#&gt; 63:    2:M:25-34     1:F:35+      123             1      F             35+
#&gt; 64:    2:M:25-34   2:F:15-24      127             2      F           15-24
#&gt; 65:    2:M:25-34   2:F:25-34      128             2      F           25-34
#&gt; 66:    2:M:25-34     2:F:35+      129             2      F             35+
#&gt; 67:      2:M:35+   1:F:15-24      133             1      F           15-24
#&gt; 68:      2:M:35+   1:F:25-34      134             1      F           25-34
#&gt; 69:      2:M:35+     1:F:35+      135             1      F             35+
#&gt; 70:      2:M:35+   2:F:15-24      139             2      F           15-24
#&gt; 71:      2:M:35+   2:F:25-34      140             2      F           25-34
#&gt; 72:      2:M:35+     2:F:35+      141             2      F             35+
#&gt;     REC_CATEGORY TR_CATEGORY COUNT_ID TR_COMM_NUM_B TR_SEX TR_AGE_AT_MID_C
#&gt;     REC_COMM_NUM_B REC_SEX REC_AGE_AT_MID_C  TR_P_SEQ REC_P_SEQ         S
#&gt;  1:              1       F            15-24 0.8320184 0.7685248 0.6394267
#&gt;  2:              1       F            15-24 0.8175745 0.7685248 0.6283262
#&gt;  3:              1       F            15-24 0.7858350 0.7685248 0.6039337
#&gt;  4:              1       F            15-24 0.6456563 0.7685248 0.4962029
#&gt;  5:              1       F            15-24 0.6224593 0.7685248 0.4783754
#&gt;  6:              1       F            15-24 0.5744425 0.7685248 0.4414733
#&gt;  7:              1       F            25-34 0.8320184 0.7502601 0.6242302
#&gt;  8:              1       F            25-34 0.8175745 0.7502601 0.6133935
#&gt;  9:              1       F            25-34 0.7858350 0.7502601 0.5895806
#&gt; 10:              1       F            25-34 0.6456563 0.7502601 0.4844102
#&gt; 11:              1       F            25-34 0.6224593 0.7502601 0.4670064
#&gt; 12:              1       F            25-34 0.5744425 0.7502601 0.4309813
#&gt; 13:              1       F              35+ 0.8320184 0.7109495 0.5915231
#&gt; 14:              1       F              35+ 0.8175745 0.7109495 0.5812542
#&gt; 15:              1       F              35+ 0.7858350 0.7109495 0.5586890
#&gt; 16:              1       F              35+ 0.6456563 0.7109495 0.4590290
#&gt; 17:              1       F              35+ 0.6224593 0.7109495 0.4425372
#&gt; 18:              1       F              35+ 0.5744425 0.7109495 0.4083996
#&gt; 19:              1       M            15-24 0.7685248 0.8320184 0.6394267
#&gt; 20:              1       M            15-24 0.7502601 0.8320184 0.6242302
#&gt; 21:              1       M            15-24 0.7109495 0.8320184 0.5915231
#&gt; 22:              1       M            15-24 0.5498340 0.8320184 0.4574720
#&gt; 23:              1       M            15-24 0.5249792 0.8320184 0.4367923
#&gt; 24:              1       M            15-24 0.4750208 0.8320184 0.3952260
#&gt; 25:              1       M            25-34 0.7685248 0.8175745 0.6283262
#&gt; 26:              1       M            25-34 0.7502601 0.8175745 0.6133935
#&gt; 27:              1       M            25-34 0.7109495 0.8175745 0.5812542
#&gt; 28:              1       M            25-34 0.5498340 0.8175745 0.4495302
#&gt; 29:              1       M            25-34 0.5249792 0.8175745 0.4292096
#&gt; 30:              1       M            25-34 0.4750208 0.8175745 0.3883649
#&gt; 31:              1       M              35+ 0.7685248 0.7858350 0.6039337
#&gt; 32:              1       M              35+ 0.7502601 0.7858350 0.5895806
#&gt; 33:              1       M              35+ 0.7109495 0.7858350 0.5586890
#&gt; 34:              1       M              35+ 0.5498340 0.7858350 0.4320788
#&gt; 35:              1       M              35+ 0.5249792 0.7858350 0.4125470
#&gt; 36:              1       M              35+ 0.4750208 0.7858350 0.3732880
#&gt; 37:              2       F            15-24 0.8320184 0.5498340 0.4574720
#&gt; 38:              2       F            15-24 0.8175745 0.5498340 0.4495302
#&gt; 39:              2       F            15-24 0.7858350 0.5498340 0.4320788
#&gt; 40:              2       F            15-24 0.6456563 0.5498340 0.3550038
#&gt; 41:              2       F            15-24 0.6224593 0.5498340 0.3422493
#&gt; 42:              2       F            15-24 0.5744425 0.5498340 0.3158480
#&gt; 43:              2       F            25-34 0.8320184 0.5249792 0.4367923
#&gt; 44:              2       F            25-34 0.8175745 0.5249792 0.4292096
#&gt; 45:              2       F            25-34 0.7858350 0.5249792 0.4125470
#&gt; 46:              2       F            25-34 0.6456563 0.5249792 0.3389561
#&gt; 47:              2       F            25-34 0.6224593 0.5249792 0.3267782
#&gt; 48:              2       F            25-34 0.5744425 0.5249792 0.3015704
#&gt; 49:              2       F              35+ 0.8320184 0.4750208 0.3952260
#&gt; 50:              2       F              35+ 0.8175745 0.4750208 0.3883649
#&gt; 51:              2       F              35+ 0.7858350 0.4750208 0.3732880
#&gt; 52:              2       F              35+ 0.6456563 0.4750208 0.3067002
#&gt; 53:              2       F              35+ 0.6224593 0.4750208 0.2956811
#&gt; 54:              2       F              35+ 0.5744425 0.4750208 0.2728722
#&gt; 55:              2       M            15-24 0.7685248 0.6456563 0.4962029
#&gt; 56:              2       M            15-24 0.7502601 0.6456563 0.4844102
#&gt; 57:              2       M            15-24 0.7109495 0.6456563 0.4590290
#&gt; 58:              2       M            15-24 0.5498340 0.6456563 0.3550038
#&gt; 59:              2       M            15-24 0.5249792 0.6456563 0.3389561
#&gt; 60:              2       M            15-24 0.4750208 0.6456563 0.3067002
#&gt; 61:              2       M            25-34 0.7685248 0.6224593 0.4783754
#&gt; 62:              2       M            25-34 0.7502601 0.6224593 0.4670064
#&gt; 63:              2       M            25-34 0.7109495 0.6224593 0.4425372
#&gt; 64:              2       M            25-34 0.5498340 0.6224593 0.3422493
#&gt; 65:              2       M            25-34 0.5249792 0.6224593 0.3267782
#&gt; 66:              2       M            25-34 0.4750208 0.6224593 0.2956811
#&gt; 67:              2       M              35+ 0.7685248 0.5744425 0.4414733
#&gt; 68:              2       M              35+ 0.7502601 0.5744425 0.4309813
#&gt; 69:              2       M              35+ 0.7109495 0.5744425 0.4083996
#&gt; 70:              2       M              35+ 0.5498340 0.5744425 0.3158480
#&gt; 71:              2       M              35+ 0.5249792 0.5744425 0.3015704
#&gt; 72:              2       M              35+ 0.4750208 0.5744425 0.2728722
#&gt;     REC_COMM_NUM_B REC_SEX REC_AGE_AT_MID_C  TR_P_SEQ REC_P_SEQ         S</div><div class='input'>
<span class='no'>N</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Poisson'>rpois</a></span>(<span class='fl'>1</span>,<span class='fl'>20</span>/<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/mean'>mean</a></span>(<span class='no'>dc</span>$<span class='no'>S</span>))
<span class='no'>z</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Multinom'>rmultinom</a></span>(<span class='fl'>1</span>,<span class='kw'>size</span><span class='kw'>=</span><span class='no'>N</span>,<span class='kw'>prob</span><span class='kw'>=</span><span class='no'>TRUE_PI</span>)
<span class='no'>n</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>NA_integer_</span>,<span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>nrow</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>TRUE_PI</span>))
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>TRUE_PI</span>)){
  <span class='no'>n</span>[<span class='no'>i</span>]<span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Binomial'>rbinom</a></span>(<span class='fl'>1</span>,<span class='kw'>size</span><span class='kw'>=</span><span class='no'>z</span>[<span class='no'>i</span>],<span class='no'>dc</span>$<span class='no'>S</span>[<span class='no'>i</span>])
}

<span class='no'>dc</span>$<span class='no'>OBS</span><span class='kw'>&lt;-</span><span class='no'>n</span>
<span class='no'>dc.obs.zero</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/which'>which</a></span>(<span class='no'>dc</span>$<span class='no'>OBS</span><span class='kw'>==</span><span class='fl'>0</span>)
<span class='no'>dc</span><span class='kw'>&lt;-</span><span class='no'>dc</span>[<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/which'>which</a></span>(<span class='no'>dc</span>$<span class='no'>OBS</span><span class='kw'>!=</span><span class='fl'>0</span>),]
<span class='no'>dc</span>$<span class='no'>COUNT_ID</span><span class='kw'>&lt;-</span><span class='fl'>1</span>:<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span>(<span class='no'>dc</span>)

<span class='co'># remove irrelevant terms</span>
<span class='no'>dg</span>$<span class='no'>P_SEQ</span><span class='kw'>&lt;-</span><span class='kw'>NULL</span>
<span class='no'>dg</span>$<span class='no'>LOGIT_P_SEQ</span><span class='kw'>&lt;-</span><span class='kw'>NULL</span>
<span class='no'>dc</span>$<span class='no'>TR_P_SEQ</span><span class='kw'>&lt;-</span><span class='kw'>NULL</span>
<span class='no'>dc</span>$<span class='no'>REC_P_SEQ</span><span class='kw'>&lt;-</span><span class='kw'>NULL</span>
<span class='no'>dc</span>$<span class='no'>S</span><span class='kw'>&lt;-</span><span class='kw'>NULL</span>

<span class='no'>df.sampling</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>()
<span class='no'>df.sampling</span><span class='kw'>[[</span><span class='fl'>1</span>]]<span class='kw'>&lt;-</span><span class='no'>dg</span>

<span class='fu'>samples.from.GLM.prior</span>(<span class='kw'>df.sampling</span><span class='kw'>=</span><span class='no'>df.sampling</span>,<span class='kw'>dc</span><span class='kw'>=</span><span class='no'>dc</span>,<span class='kw'>iteration</span><span class='kw'>=</span><span class='fl'>1e6</span>,<span class='kw'>sample.method</span><span class='kw'>=</span><span class='st'>'empirical'</span>,<span class='kw'>glm.model</span><span class='kw'>=</span><span class='st'>'binomial'</span>,<span class='kw'>seed</span><span class='kw'>=</span><span class='fl'>123</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: ggplot2</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: StanHeaders</span></div><div class='output co'>#&gt; <span class='warning'>Warning: package ‘StanHeaders’ was built under R version 3.5.2</span></div><div class='output co'>#&gt; <span class='message'>rstan (Version 2.18.2, GitRev: 2e1f913d3ca3)</span></div><div class='output co'>#&gt; <span class='message'>For execution on a local, multicore CPU with excess RAM we recommend calling</span>
#&gt; <span class='message'>options(mc.cores = parallel::detectCores()).</span>
#&gt; <span class='message'>To avoid recompilation of unchanged Stan programs, we recommend calling</span>
#&gt; <span class='message'>rstan_options(auto_write = TRUE)</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘rstan’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:coda’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    traceplot</span></div><div class='output co'>#&gt; <span class='warning'>Warning: package ‘fitdistrplus’ was built under R version 3.5.2</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: survival</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: npsurv</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: lsei</span></div><div class='output co'>#&gt; <span class='error'>Error in is.data.table(y): object 'dg' not found</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
            
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Xiaoyue Xi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

