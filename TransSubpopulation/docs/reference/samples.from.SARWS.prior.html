<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Drawing samples from the prior distribution under sampling at random within strata (SARWS) assumption. — samples.from.SARWS.prior • TransSubpopulation</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Drawing samples from the prior distribution under sampling at random within strata (SARWS) assumption. — samples.from.SARWS.prior" />

<meta property="og:description" content="This function provides the inputs for mcmc sampler. Samples are drawn from the prior distribution of the sampling rate and evaluate corresponding density. The prior distribution is informative and given by a posterior distribution inferred from Bayesian hierarchical model using the number of individuals who are eligible and sampled under the assumption of missing at random within strata (SARWS)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TransSubpopulation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Source_attribution_under_GLM.html">Source attribution while sampling are structured under the GLM assumption</a>
    </li>
    <li>
      <a href="../articles/Source_attribution_under_SARWS_assumption.html">Source attribution while sampling are structured under the SARWS assumption</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Drawing samples from the prior distribution under sampling at random within strata (SARWS) assumption.</h1>
    
    <div class="hidden name"><code>samples.from.SARWS.prior.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function provides the inputs for mcmc sampler. Samples are drawn from the prior distribution of the sampling rate and evaluate corresponding density. The prior distribution is informative and given by a posterior distribution inferred from Bayesian hierarchical model using the number of individuals who are eligible and sampled under the assumption of missing at random within strata (SARWS).</p>
    
    </div>

    <pre class="usage"><span class='fu'>samples.from.SARWS.prior</span>(<span class='no'>df.sampling</span>,<span class='no'>dc</span>,<span class='no'>iteration</span>,<span class='no'>seed</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>df.sampling</th>
      <td><p>a list of data tables each of which includes data used for infering the distribution of sampling rates through a hierarchical model, i.e. the number of eligible individuals and individual sampled in each subpopulation.</p></td>
    </tr>
    <tr>
      <th>iteration</th>
      <td><p>the number of iterations for mcmc sampler, which decides the number of prior samples needed.</p></td>
    </tr>
    <tr>
      <th>dc</th>
      <td><p>a data table includes transmission counts between subpopulations and covariates of transmitters' and recipients' subpopulations.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>the random seed.</p></td>
    </tr>
    </table>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>data.table</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>123</span>)
<span class='co'># dg</span>
<span class='no'>dg</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/data.table'>data.table</a></span>(<span class='kw'>CATEGORY</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>),<span class='kw'>TRIAL</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>2000</span>,<span class='fl'>2500</span>),<span class='kw'>P_SEQ_EMP</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.6</span>,<span class='fl'>0.45</span>))
<span class='no'>dg</span>[,<span class='no'>SUC</span><span class='kw'>:=</span><span class='no'>TRIAL</span>*<span class='no'>P_SEQ_EMP</span>]</div><div class='output co'>#&gt;    CATEGORY TRIAL P_SEQ_EMP  SUC
#&gt; 1:        1  2000      0.60 1200
#&gt; 2:        2  2500      0.45 1125</div><div class='input'><span class='co'># dc</span>
<span class='no'>dc</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/data.table'>data.table</a></span>(<span class='kw'>TR_CATEGORY</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>2</span>),<span class='kw'>REC_CATEGORY</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='no'>tmp</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/subset.data.table'>subset</a></span>(<span class='no'>dg</span>,<span class='kw'>select</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>'CATEGORY'</span>,<span class='st'>'P_SEQ_EMP'</span>))
<span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/setattr'>setnames</a></span>(<span class='no'>tmp</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>tmp</span>),<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>'TR_'</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>tmp</span>)))
<span class='no'>dc</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/merge'>merge</a></span>(<span class='no'>dc</span>,<span class='no'>tmp</span>,<span class='kw'>by</span><span class='kw'>=</span><span class='st'>'TR_CATEGORY'</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/setattr'>setnames</a></span>(<span class='no'>tmp</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>tmp</span>),<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/grep'>gsub</a></span>(<span class='st'>'TR_'</span>,<span class='st'>'REC_'</span>,<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>tmp</span>)))
<span class='no'>dc</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/data.table/topics/merge'>merge</a></span>(<span class='no'>dc</span>,<span class='no'>tmp</span>,<span class='kw'>by</span><span class='kw'>=</span><span class='st'>'REC_CATEGORY'</span>)
<span class='no'>dc</span>[,<span class='no'>S</span><span class='kw'>:=</span><span class='no'>TR_P_SEQ_EMP</span>*<span class='no'>REC_P_SEQ_EMP</span>]</div><div class='output co'>#&gt;    REC_CATEGORY TR_CATEGORY TR_P_SEQ_EMP REC_P_SEQ_EMP      S
#&gt; 1:            1           1         0.60          0.60 0.3600
#&gt; 2:            1           2         0.45          0.60 0.2700
#&gt; 3:            2           1         0.60          0.45 0.2700
#&gt; 4:            2           2         0.45          0.45 0.2025</div><div class='input'>
<span class='co'># transmission proportions</span>
<span class='no'>TRUE_PI</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.36</span>,<span class='fl'>0.04</span>,<span class='fl'>0.06</span>,<span class='fl'>0.54</span>)

<span class='co'># assume observed transmission counts are 300</span>
<span class='no'>N</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Poisson'>rpois</a></span>(<span class='fl'>1</span>,<span class='fl'>300</span>/<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/mean'>mean</a></span>(<span class='no'>dc</span>$<span class='no'>S</span>))
<span class='no'>z</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Multinom'>rmultinom</a></span>(<span class='fl'>1</span>,<span class='kw'>size</span><span class='kw'>=</span><span class='no'>N</span>,<span class='kw'>prob</span><span class='kw'>=</span><span class='no'>TRUE_PI</span>)
<span class='no'>n</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fl'>NA_integer_</span>,<span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>nrow</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>TRUE_PI</span>))
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>TRUE_PI</span>)){
  <span class='no'>n</span>[<span class='no'>i</span>]<span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Binomial'>rbinom</a></span>(<span class='fl'>1</span>,<span class='kw'>size</span><span class='kw'>=</span><span class='no'>z</span>[<span class='no'>i</span>],<span class='no'>dc</span>$<span class='no'>S</span>[<span class='no'>i</span>])
}

<span class='no'>dc</span>$<span class='no'>OBS</span><span class='kw'>&lt;-</span><span class='no'>n</span>
<span class='no'>dc</span>$<span class='no'>COUNT_ID</span><span class='kw'>&lt;-</span><span class='fl'>1</span>:<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span>(<span class='no'>dc</span>)

<span class='co'># remove irrelevant terms</span>
<span class='no'>dg</span>$<span class='no'>P_SEQ_EMP</span><span class='kw'>&lt;-</span><span class='kw'>NULL</span>
<span class='no'>dc</span>$<span class='no'>TR_P_SEQ_EMP</span><span class='kw'>&lt;-</span><span class='kw'>NULL</span>
<span class='no'>dc</span>$<span class='no'>REC_P_SEQ_EMP</span><span class='kw'>&lt;-</span><span class='kw'>NULL</span>
<span class='no'>dc</span>$<span class='no'>S</span><span class='kw'>&lt;-</span><span class='kw'>NULL</span>

<span class='no'>df.sampling</span><span class='kw'>&lt;-</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>()
<span class='no'>df.sampling</span><span class='kw'>[[</span><span class='fl'>1</span>]]<span class='kw'>&lt;-</span><span class='no'>dg</span>

<span class='fu'>samples.from.SARWS.prior</span>(<span class='kw'>df.sampling</span><span class='kw'>=</span><span class='no'>df.sampling</span>,<span class='kw'>dc</span><span class='kw'>=</span><span class='no'>dc</span>,<span class='kw'>iteration</span><span class='kw'>=</span><span class='fl'>1e6</span>,<span class='kw'>seed</span><span class='kw'>=</span><span class='fl'>123</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
            
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Xiaoyue Xi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

